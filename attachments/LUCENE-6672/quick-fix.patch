diff --git a/lucene/core/src/java/org/apache/lucene/util/automaton/CompiledAutomaton.java b/lucene/core/src/java/org/apache/lucene/util/automaton/CompiledAutomaton.java
index f10d177..a796f04 100644
--- a/lucene/core/src/java/org/apache/lucene/util/automaton/CompiledAutomaton.java
+++ b/lucene/core/src/java/org/apache/lucene/util/automaton/CompiledAutomaton.java
@@ -228,6 +228,9 @@
     } else {
       // Incoming automaton is unicode, and we must convert to UTF8 to match what's in the index:
       binary = new UTF32ToUTF8().convert(automaton);
+      if(binary.getNumStates() > maxDeterminizedStates) {
+        throw new TooComplexToDeterminizeException(automaton, maxDeterminizedStates);
+      }
     }
 
     if (this.finite) {