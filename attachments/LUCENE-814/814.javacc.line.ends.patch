Index: common-build.xml
===================================================================
--- common-build.xml	(revision 510176)
+++ common-build.xml	(working copy)
@@ -310,5 +310,14 @@
     </sequential>
   </macrodef>
 
+  <macrodef name="replace-dos-line-endings-to-unix">
+    <attribute name="textfile"/>
+    <sequential>
+      <replaceregexp file="@{textfile}" flags="g" match="\r\n" replace="&#xA;" /> 
+      <replaceregexp file="@{textfile}" flags="g" match="\r" replace="&#xA;" /> 
+   </sequential>
+  </macrodef>
+
 </project>
 
+
Index: build.xml
===================================================================
--- build.xml	(revision 510711)
+++ build.xml	(working copy)
@@ -318,6 +318,18 @@
     <invoke-javacc target="src/java/org/apache/lucene/queryParser/QueryParser.jj"
                    outputDir="src/java/org/apache/lucene/queryParser"
     />
+    <replace-dos-line-endings-to-unix 
+      textfile="src/java/org/apache/lucene/queryParser/QueryParser.java"
+   />
+    <replace-dos-line-endings-to-unix 
+      textfile="src/java/org/apache/lucene/queryParser/QueryParserTokenManager.java"
+   />
+    <replace-dos-line-endings-to-unix 
+      textfile="src/java/org/apache/lucene/queryParser/QueryParserConstants.java"
+   />
+    <replace-dos-line-endings-to-unix 
+      textfile="src/java/org/apache/lucene/queryParser/CharStream.java"
+   />
   </target>
   
   <target name="javacc-HTMLParser" depends="init,javacc-check" if="javacc.present">
