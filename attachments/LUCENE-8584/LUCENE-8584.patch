diff --git a/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java b/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
index bf2ef57f3d..8faadd5ae7 100644
--- a/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
+++ b/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
@@ -102,7 +102,8 @@ public final class UserDictionary implements Dictionary {
     Builder<Long> fstBuilder = new Builder<>(FST.INPUT_TYPE.BYTE2, fstOutput);
     IntsRefBuilder scratch = new IntsRefBuilder();
     long ord = 0;
-    
+
+    String lastToken = null;
     for (String[] values : featureEntries) {
       String[] segmentation = values[1].replaceAll("  *", " ").split(" ");
       String[] readings = values[2].replaceAll("  *", " ").split(" ");
@@ -113,6 +114,10 @@ public final class UserDictionary implements Dictionary {
                                    " - the number of segmentations (" + segmentation.length + ")" +
                                    " does not the match number of readings (" + readings.length + ")");
       }
+      String token = values[0];
+      if (token.equals(lastToken)) {
+        continue;
+      }
       
       int[] wordIdAndLength = new int[segmentation.length + 1]; // wordId offset, length, length....
       wordIdAndLength[0] = wordId;
@@ -122,7 +127,6 @@ public final class UserDictionary implements Dictionary {
         wordId++;
       }
       // add mapping to FST
-      String token = values[0];
       scratch.grow(token.length());
       scratch.setLength(token.length());
       for (int i = 0; i < token.length(); i++) {
@@ -131,6 +135,7 @@ public final class UserDictionary implements Dictionary {
       fstBuilder.add(scratch.get(), ord);
       segmentations.add(wordIdAndLength);
       ord++;
+      lastToken = token;
     }
     this.fst = new TokenInfoFST(fstBuilder.finish(), false);
     this.data = data.toArray(new String[data.size()]);
diff --git a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
index f9db02c22c..aa55f359fd 100644
--- a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
+++ b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
@@ -4,7 +4,11 @@
 
 # Custom reading for sumo wrestler
 朝青龍,朝青龍,アサショウリュウ,カスタム人名
+# Duplicate entry that should be removed
+朝青龍,朝青龍,アサショウリュウ,カスタム人名
 
 # Silly entry:
 abcd,a b cd,foo1 foo2 foo3,bar
 abcdefg,ab cd efg,foo1 foo2 foo4,bar
+# Duplicate entry that should be removed
+abcd,a b cd,foo1 foo2 foo3,bar
