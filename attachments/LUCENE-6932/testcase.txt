  public void testShouldThrowEOFException() throws Exception {
    final Random random = random();

    try (Directory dir = newDirectory()) {
      final int len = 16 + random().nextInt(2048) / 16 * 16;
      final byte[] bytes = new byte[len];

      try (IndexOutput os = dir.createOutput("foo", newIOContext(random))) {
        os.writeBytes(bytes, bytes.length);
      }

      try (IndexInput is = dir.openInput("foo", newIOContext(random))) {
        try {
          is.seek(0);
          // Here, I go past EOF.
          is.seek(len + random().nextInt(2048));
          // since EOF is not enforced by the previous call in RAMInputStream
          // this call to readBytes should throw the exception.
          is.readBytes(bytes, 0, 16);
          fail("Did not get EOFException");
        } catch (EOFException eof) {
          // pass
        }
      }
    }
  }
