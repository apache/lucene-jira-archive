diff --git a/lucene/analysis/common/build.xml b/lucene/analysis/common/build.xml
index c3d4fcca8b2..4f1c549873a 100644
--- a/lucene/analysis/common/build.xml
+++ b/lucene/analysis/common/build.xml
@@ -61,7 +61,12 @@
     <run-jflex dir="src/java/org/apache/lucene/analysis/standard" name="ClassicTokenizerImpl"/>
   </target>
 
-  <target name="-jflex-UAX29URLEmailTokenizer" depends="-install-jflex">
+  <target name="-jflex-UAX29URLEmailTokenizer" depends="-install-jflex,resolve-groovy">
+    <groovy><![CDATA[
+      if (Runtime.getRuntime().maxMemory() < 12_000_000_000) {
+        throw new RuntimeException('Please run ANT_OPTS="-Xms12G -Xmx12G" ant ... for doing this task')
+      }
+    ]]></groovy>
     <run-jflex-and-disable-buffer-expansion
         dir="src/java/org/apache/lucene/analysis/standard" name="UAX29URLEmailTokenizerImpl"/>
   </target>
