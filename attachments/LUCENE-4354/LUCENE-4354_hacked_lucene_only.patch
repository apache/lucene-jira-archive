Index: lucene/build.xml
===================================================================
--- lucene/build.xml	(revision 1380554)
+++ lucene/build.xml	(working copy)
@@ -529,4 +529,20 @@
     <jar-checksum-macro srcdir="${common.dir}" dstdir="${common.dir}/licenses"/>
   </target>
 
+  <target name="maven-check-licenses" depends="compile-tools,load-custom-tasks,install-maven-tasks">
+    <sequential>
+      <artifact:dependencies xmlns:maven="urn:maven-artifact-ant" filesetId="maven.fileset" useScope="test">
+        <artifact:pom file="${common.dir}/../maven-build/lucene/pom.xml"/>
+        <artifact:localRepository path="${user.home}/.m2/repository"/>
+      </artifact:dependencies>
+      <echo>Checking Maven dependencies: ${toString:maven.fileset}</echo>
+    <licenses licenseDirectory="${common.dir}/licenses">
+      <fileset refid="maven.fileset"/>
+      <licenseMapper>
+        <filtermapper refid="license-mapper-defaults"/>
+      </licenseMapper>
+    </licenses>
+    </sequential>
+  </target>
+
 </project>
Index: lucene/tools/custom-tasks.xml
===================================================================
--- lucene/tools/custom-tasks.xml	(revision 1380530)
+++ lucene/tools/custom-tasks.xml	(working copy)
@@ -16,6 +16,23 @@
     <property name="custom-tasks.loaded" value="true"/>
   </target>
 
+  <filtermapper id="license-mapper-defaults">
+    <!-- Normalize input paths. -->
+    <replacestring from="\" to="/" />
+    <replaceregex pattern="\.jar$" replace="" flags="gi" />
+    
+    <!-- Some typical snapshot/minimalized JAR suffixes. -->
+    <replaceregex pattern="-min$" replace="" flags="gi" />
+    <replaceregex pattern="SNAPSHOT$" replace="" flags="gi" />
+
+    <!-- Typical version patterns. -->
+    <replaceregex pattern="\.rc[0-9]+" replace="" flags="gi" />
+    <replaceregex pattern="\-(r)?([0-9\-\_\.])+(b(eta)?([0-9\-\.])*)?$" replace="" flags="gi" />
+
+    <!-- git hashcode pattern: its always 40 chars right? -->
+    <replaceregex pattern="\-[a-z0-9]{40,40}$" replace="" flags="gi" />
+  </filtermapper>
+
   <macrodef name="license-check-macro">
     <attribute name="dir" />
     <attribute name="licensedir" />
@@ -38,25 +55,13 @@
         </fileset>
 
         <licenseMapper>
-          <filtermapper id="license-mapper-defaults">
-            <!-- Normalize input paths. -->
-            <replacestring from="\" to="/" />
-            <replaceregex pattern="\.jar$" replace="" flags="gi" />
-    
-            <!-- Some typical snapshot/minimalized JAR suffixes. -->
-            <replaceregex pattern="-min$" replace="" flags="gi" />
-            <replaceregex pattern="SNAPSHOT$" replace="" flags="gi" />
-
-            <!-- Non-typical version patterns. -->
-            <additional-filters />
-
-            <!-- Typical version patterns. -->
-            <replaceregex pattern="\.rc[0-9]+" replace="" flags="gi" />
-            <replaceregex pattern="\-(r)?([0-9\-\_\.])+(b(eta)?([0-9\-\.])*)?$" replace="" flags="gi" />
-
-            <!-- git hashcode pattern: its always 40 chars right? -->
-            <replaceregex pattern="\-[a-z0-9]{40,40}$" replace="" flags="gi" />
-          </filtermapper>
+          <chainedmapper>
+            <filtermapper refid="license-mapper-defaults"/>
+            <filtermapper>
+              <!-- Non-typical version patterns. -->
+              <additional-filters />
+            </filtermapper>
+          </chainedmapper>
         </licenseMapper>
       </licenses>
     </sequential>
Index: solr/build.xml
===================================================================
--- solr/build.xml	(revision 1380554)
+++ solr/build.xml	(working copy)
@@ -183,7 +183,6 @@
       </additional-excludes>
       <additional-filters>
         <replaceregex pattern="jetty([^/]+)$" replace="jetty" flags="gi" />
-        <replaceregex pattern="apache-solr-commons-csv-([^/]+)$" replace="apache-solr-commons-csv" flags="gi" />
         <replaceregex pattern="slf4j-([^/]+)$" replace="slf4j" flags="gi" />
         <replaceregex pattern="(bcmail|bcprov)-([^/]+)$" replace="\1" flags="gi" />
       </additional-filters>
@@ -756,4 +755,23 @@
     <jar-checksum-macro srcdir="${common-solr.dir}" dstdir="${common-solr.dir}/licenses"/>
   </target>
 
+  <target name="-maven-check-licenses" depends="compile-tools,load-custom-tasks">
+    <license-check-macro dir="${common-solr.dir}/../maven-build/solr" licensedir="${common-solr.dir}/licenses">
+      <additional-excludes>
+        <!-- Exclude start.jar only (it'd be weird to have a license file there?) -->
+        <exclude name="example/start.jar" />
+        <exclude name="example/exampledocs/post.jar" />
+        <exclude name="example/solr-webapp/**" />
+        <!-- exclude internal dependencies -->
+        <exclude name="**/lucene-*.jar" />
+        <exclude name="**/solr-*.jar" />
+      </additional-excludes>
+      <additional-filters>
+        <replaceregex pattern="jetty([^/]+)$" replace="jetty" flags="gi" />
+        <replaceregex pattern="slf4j-([^/]+)$" replace="slf4j" flags="gi" />
+        <replaceregex pattern="(bcmail|bcprov)-([^/]+)$" replace="\1" flags="gi" />
+      </additional-filters>
+    </license-check-macro>
+  </target>
+
 </project>
Index: build.xml
===================================================================
--- build.xml	(revision 1380554)
+++ build.xml	(working copy)
@@ -286,4 +286,17 @@
   <target name="-jenkins-javadocs-lint" unless="-disable.javadocs-lint">
     <antcall target="javadocs-lint"/> 
   </target>
+
+  <!-- TODO: we should not do this here, instead use the maven-ant-tasks plugin in common-build etc etc -->
+  <target name="validate-maven" depends="get-maven-poms">
+    <sequential>
+      <exec dir="maven-build" executable="mvn">
+        <arg line="dependency:copy-dependencies"/>
+      </exec>
+      <subant target="-maven-check-licenses" inheritall="false" failonerror="true">
+        <fileset dir="lucene" includes="build.xml" />
+        <fileset dir="solr" includes="build.xml" />
+      </subant>
+    </sequential>
+  </target>
 </project>
