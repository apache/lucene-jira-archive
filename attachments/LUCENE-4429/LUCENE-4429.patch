Index: build.xml
===================================================================
--- build.xml	(revision 1390137)
+++ build.xml	(working copy)
@@ -249,7 +249,7 @@
   <property name="python32.exe" value="python3.2" />
   <property name="fakeRelease" value="lucene/build/fakeRelease"/>
   <property name="fakeReleaseTmp" value="lucene/build/fakeReleaseTmp"/>
-  <property name="fakeReleaseVersion" value="5.0"/> <!-- *not* -SNAPSHOT, the real version -->
+  <property name="fakeReleaseVersion" value="5.0.0"/> <!-- *not* -SNAPSHOT, the real version -->
 
   <target name="nightly-smoke" description="Builds an unsigned release and smoke tests it" depends="clean">
    <sequential>
Index: dev-tools/scripts/smokeTestRelease.py
===================================================================
--- dev-tools/scripts/smokeTestRelease.py	(revision 1390139)
+++ dev-tools/scripts/smokeTestRelease.py	(working copy)
@@ -1106,6 +1106,8 @@
         downloadedFiles.append(path)
         sys.stdout.write('.')
 
+reAllowedVersion = re.compile(r'^\d+\.\d+\.\d+(-alpha|-beta)?$')
+
 def main():
 
   if len(sys.argv) < 4:
@@ -1116,6 +1118,10 @@
 
   baseURL = sys.argv[1]
   version = sys.argv[2]
+
+  if not reAllowedVersion.match(version):
+    raise RuntimeError('version "%s" does not match X.Y.Z[-ALPHA|-BETA]' % version)
+  
   tmpDir = os.path.abspath(sys.argv[3])
   isSigned = True 
   if len(sys.argv) == 5:
