From ad9558316cbfbad0b554033044baaa0657bb023a Mon Sep 17 00:00:00 2001
From: Jeff Wartes <jeff@lanndark.com>
Date: Tue, 12 Apr 2016 12:21:40 -0700
Subject: [PATCH] SOLR-8944 - Use DocIdSetBuilder instead of FixedBitSets in
 IntersectsPrefixTreeQuery

---
 .../apache/lucene/spatial/prefix/IntersectsPrefixTreeQuery.java    | 7 ++++---
 1 file changed, 4 insertions(+), 3 deletions(-)

diff --git a/lucene/spatial/src/java/org/apache/lucene/spatial/prefix/IntersectsPrefixTreeQuery.java b/lucene/spatial/src/java/org/apache/lucene/spatial/prefix/IntersectsPrefixTreeQuery.java
index d0e4927..4bda2e3 100644
--- a/lucene/spatial/src/java/org/apache/lucene/spatial/prefix/IntersectsPrefixTreeQuery.java
+++ b/lucene/spatial/src/java/org/apache/lucene/spatial/prefix/IntersectsPrefixTreeQuery.java
@@ -26,6 +26,7 @@ import org.apache.lucene.search.DocIdSet;
 import org.apache.lucene.spatial.prefix.tree.Cell;
 import org.apache.lucene.spatial.prefix.tree.SpatialPrefixTree;
 import org.apache.lucene.util.BitDocIdSet;
+import org.apache.lucene.util.DocIdSetBuilder;
 import org.apache.lucene.util.FixedBitSet;
 
 /**
@@ -54,16 +55,16 @@ public class IntersectsPrefixTreeQuery extends AbstractVisitingPrefixTreeQuery {
 
      */
     return new VisitorTemplate(context) {
-      private FixedBitSet results;
+      private DocIdSetBuilder results;
 
       @Override
       protected void start() {
-        results = new FixedBitSet(maxDoc);
+        results = new DocIdSetBuilder(maxDoc);
       }
 
       @Override
       protected DocIdSet finish() {
-        return new BitDocIdSet(results);
+        return results.build();
       }
 
       @Override
-- 
2.6.4 (Apple Git-63)

