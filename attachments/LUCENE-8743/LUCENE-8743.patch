diff --git a/lucene/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java b/lucene/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java
index 5d98fbaec74..d05a472e310 100644
--- a/lucene/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java
+++ b/lucene/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java
@@ -49,7 +49,7 @@ public class DOMUtils {
 
   public static String getAttributeOrFail(Element e, String name) throws ParserException {
     String v = e.getAttribute(name);
-    if (null == v) {
+    if (null == v || 0 == v.length()) {
       throw new ParserException(e.getTagName() + " missing \"" + name
           + "\" attribute");
     }
diff --git a/lucene/queryparser/src/test/org/apache/lucene/queryparser/xml/TestCoreParser.java b/lucene/queryparser/src/test/org/apache/lucene/queryparser/xml/TestCoreParser.java
index 3fe3ccb6ed0..29234baf0b1 100644
--- a/lucene/queryparser/src/test/org/apache/lucene/queryparser/xml/TestCoreParser.java
+++ b/lucene/queryparser/src/test/org/apache/lucene/queryparser/xml/TestCoreParser.java
@@ -136,7 +136,7 @@ public class TestCoreParser extends LuceneTestCase {
   }
 
   public void testSpanNearQueryWithoutSlopXML() throws Exception {
-    Exception expectedException = new NumberFormatException("For input string: \"\"");
+    Exception expectedException = new ParserException("SpanNear missing \"slop\" attribute");
     try {
       Query q = parse("SpanNearQueryWithoutSlop.xml");
       fail("got query "+q+" instead of expected exception "+expectedException);
