Index: src/test/org/apache/lucene/index/TestCompoundFile.java
===================================================================
--- src/test/org/apache/lucene/index/TestCompoundFile.java	(revision 382277)
+++ src/test/org/apache/lucene/index/TestCompoundFile.java	(working copy)
@@ -622,4 +622,26 @@
         is.close();
         cr.close();
     }
+
+    /** This test that writes larger than the size of the buffer output
+     * will correctly increment the file pointer.
+     */
+    public void testLargeWrites() throws IOException {
+        IndexOutput os = dir.createOutput("testBufferStart.txt");
+
+        byte[] largeBuf = new byte[2048];
+        for (int i=0; i<largeBuf.length; i++) {
+            largeBuf[i] = (byte) (Math.random() * 256);
+        }
+
+        long currentPos = os.getFilePointer();
+        os.writeBytes(largeBuf, largeBuf.length);
+
+        try {
+            assertEquals(currentPos + largeBuf.length, os.getFilePointer());
+        } finally {
+            os.close();
+        }
+
+    }
 }
Index: src/java/org/apache/lucene/store/BufferedIndexOutput.java
===================================================================
--- src/java/org/apache/lucene/store/BufferedIndexOutput.java	(revision 382277)
+++ src/java/org/apache/lucene/store/BufferedIndexOutput.java	(working copy)
@@ -58,6 +58,7 @@
           flush();
         // and write data at once
         flushBuffer(b, length);
+        bufferStart += length;
       } else {
         // we fill/flush the buffer (until the input is written)
         int pos = 0; // position in the input data
