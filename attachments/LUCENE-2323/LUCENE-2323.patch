Index: lucene/build.xml
===================================================================
--- lucene/build.xml	(revision 924935)
+++ lucene/build.xml	(working copy)
@@ -287,14 +287,12 @@
           <packageset dir="contrib/icu/src/java"/>
           <packageset dir="contrib/db/bdb-je/src/java"/>
           <packageset dir="contrib/db/bdb/src/java"/>
-          <packageset dir="contrib/fast-vector-highlighter/src/java"/>
           <packageset dir="contrib/highlighter/src/java"/>
           <packageset dir="contrib/instantiated/src/java"/>
           <packageset dir="contrib/lucli/src/java"/>
           <packageset dir="contrib/memory/src/java"/>
           <packageset dir="contrib/misc/src/java"/>
           <packageset dir="contrib/queries/src/java"/>
-          <packageset dir="contrib/regex/src/java"/>
           <packageset dir="contrib/remote/src/java"/>
           <packageset dir="contrib/spatial/src/java"/>
           <packageset dir="contrib/spellchecker/src/java"/>
@@ -319,15 +317,13 @@
           <group title="contrib: Benchmark" packages="org.apache.lucene.benchmark*"/>
           <group title="contrib: ICU" packages="org.apache.lucene.collation*"/>
           <group title="contrib: DB" packages="org.apache.lucene.store.db*:org.apache.lucene.store.je*:com.sleepycat*"/>
-          <group title="contrib: Fast Vector Highlighter" packages="org.apache.lucene.search.vectorhighlight*"/>
-          <group title="contrib: Highlighter" packages="org.apache.lucene.search.highlight*"/>
+          <group title="contrib: Highlighter" packages="org.apache.lucene.search.highlight:*org.apache.lucene.search.vectorhighlight*"/>
           <group title="contrib: Instantiated" packages="org.apache.lucene.store.instantiated*"/>
           <group title="contrib: Lucli" packages="lucli*"/>
           <group title="contrib: Memory" packages="org.apache.lucene.index.memory*"/>
-          <group title="contrib: Misc " packages="org.apache.lucene.misc*:org.apache.lucene.queryParser.analyzing*:org.apache.lucene.queryParser.precedence*"/>
-          <group title="contrib: Queries" packages="org.apache.lucene.search.similar*"/>
+          <group title="contrib: Misc " packages="org.apache.lucene.misc*"/>
+          <group title="contrib: Queries" packages="org.apache.lucene.search.similar*:org.apache.lucene.search.regex*:org.apache.regexp*"/>
           <group title="contrib: Query Parser" packages="org.apache.lucene.queryParser.*"/>
-          <group title="contrib: RegEx" packages="org.apache.lucene.search.regex*:org.apache.regexp*"/>
           <group title="contrib: Spatial" packages="org.apache.lucene.spatial*"/>
           <group title="contrib: SpellChecker" packages="org.apache.lucene.search.spell*"/>
           <group title="contrib: Surround Parser" packages="org.apache.lucene.queryParser.surround*"/>
Index: lucene/contrib/benchmark/build.xml
===================================================================
--- lucene/contrib/benchmark/build.xml	(revision 924892)
+++ lucene/contrib/benchmark/build.xml	(working copy)
@@ -130,7 +130,6 @@
         <pathelement path="${common.dir}/build/classes/demo"/>
         <pathelement path="${common.dir}/build/contrib/highlighter/classes/java"/>
         <pathelement path="${common.dir}/build/contrib/memory/classes/java"/>
-        <pathelement path="${common.dir}/build/contrib/fast-vector-highlighter/classes/java"/>
         <pathelement path="${common.dir}/build/contrib/analyzers/common/classes/java"/>
     	<fileset dir="lib">
     		<include name="**/*.jar"/>
@@ -244,12 +243,7 @@
          <fileset dir="${common.dir}/contrib/memory" includes="build.xml"/>
       </subant>
     </target>
-    <target name="compile-vector-highlighter">
-      <subant target="compile">
-         <fileset dir="${common.dir}/contrib/fast-vector-highlighter" includes="build.xml"/>
-      </subant>
-    </target>
 
-    <target name="init" depends="common.init,compile-demo,compile-memory,compile-highlighter,compile-vector-highlighter"/>
+    <target name="init" depends="common.init,compile-demo,compile-memory,compile-highlighter"/>
     
 </project>
Index: lucene/contrib/highlighter/build.xml
===================================================================
--- lucene/contrib/highlighter/build.xml	(revision 924892)
+++ lucene/contrib/highlighter/build.xml	(working copy)
@@ -28,25 +28,25 @@
   <property name="memory.jar" location="${common.dir}/build/contrib/memory/lucene-memory-${version}.jar"/>
   <available property="memory.jar.present" type="file" file="${memory.jar}"/>
   
-  <property name="regex.jar" location="${common.dir}/build/contrib/regex/lucene-regex-${version}.jar"/>
-  <available property="regex.jar.present" type="file" file="${regex.jar}"/>
+  <property name="queries.jar" location="${common.dir}/build/contrib/queries/lucene-queries-${version}.jar"/>
+  <available property="queries.jar.present" type="file" file="${queries.jar}"/>
 
   <path id="classpath">
     <pathelement path="${lucene.jar}"/>
     <pathelement path="${memory.jar}"/>
-    <pathelement path="${regex.jar}"/>
+    <pathelement path="${queries.jar}"/>
     <pathelement path="${project.classpath}"/>
   </path>
 
-  <target name="compile-core" depends="build-memory, build-regex, common.compile-core" />
+  <target name="compile-core" depends="build-memory, build-queries, common.compile-core" />
 
   <target name="build-memory" unless="memory.jar.present">
     <echo>Highlighter building dependency ${memory.jar}</echo>
     <ant antfile="../memory/build.xml" target="default" inheritall="false" dir="../memory" />
   </target>
   
-  <target name="build-regex" unless="regex.jar.present">
-    <echo>Highlighter building dependency ${regex.jar}</echo>
-    <ant antfile="../regex/build.xml" target="default" inheritall="false" dir="../regex" />
+  <target name="build-queries" unless="queries.jar.present">
+    <echo>Highlighter building dependency ${queries.jar}</echo>
+    <ant antfile="../queries/build.xml" target="default" inheritall="false" dir="../queries" />
   </target>
 </project>
Index: lucene/contrib/misc/build.xml
===================================================================
--- lucene/contrib/misc/build.xml	(revision 924892)
+++ lucene/contrib/misc/build.xml	(working copy)
@@ -27,17 +27,4 @@
 
   <import file="../contrib-build.xml"/>
 
-  <property name="javacc.path" location="src/java/org/apache/lucene/queryParser/precedence"/>
-
-  <target name="javacc" depends="javacc-check" description="generate precedence query parser from jj (requires javacc 3.2)">
-    <delete>
-      <fileset dir="${javacc.path}" includes="*.java">
-        <containsregexp expression="Generated.*By.*JavaCC"/>
-      </fileset>
-    </delete>
-    <invoke-javacc target="${javacc.path}/PrecedenceQueryParser.jj"
-                   outputDir="${javacc.path}"
-    />
-  </target>
-
 </project>
Index: lucene/contrib/queries/README.txt
===================================================================
--- lucene/contrib/queries/README.txt	(revision 924892)
+++ lucene/contrib/queries/README.txt	(working copy)
@@ -17,6 +17,7 @@
 a sequence. An example might be a collection of primary keys from a database query result or perhaps 
 a choice of "category" labels picked by the end user.
 
+==== RegexQuery - Implements the regular expression term search query. 
 
 Mark Harwood
 25/02/2006
Index: lucene/contrib/queries/build.xml
===================================================================
--- lucene/contrib/queries/build.xml	(revision 924892)
+++ lucene/contrib/queries/build.xml	(working copy)
@@ -23,5 +23,14 @@
     Queries - various query object exotica not in core
   </description>
 
+  <path id="additional.dependencies">
+    <fileset dir="lib" includes="*-oro-*.jar,*-regexp-*.jar"/>
+  </path>
+
+  <pathconvert property="project.classpath"
+               targetos="unix"
+               refid="additional.dependencies"
+  />
+
   <import file="../contrib-build.xml"/>
 </project>
Index: lucene/contrib/queries/pom.xml.template
===================================================================
--- lucene/contrib/queries/pom.xml.template	(revision 924892)
+++ lucene/contrib/queries/pom.xml.template	(working copy)
@@ -35,4 +35,11 @@
     Queries - various query object exotica not in core
   </description>
   <packaging>jar</packaging>
+  <dependencies>
+    <dependency>
+      <groupId>jakarta-regexp</groupId>
+      <artifactId>jakarta-regexp</artifactId>
+      <version>${jakarta-regexp-version}</version>
+    </dependency>
+  </dependencies>
 </project>
Index: lucene/contrib/queryparser/build.xml
===================================================================
--- lucene/contrib/queryparser/build.xml	(revision 924892)
+++ lucene/contrib/queryparser/build.xml	(working copy)
@@ -28,7 +28,9 @@
   <!--
     NOTE: see the README.javacc for details on how to fully regenerate the parser
   -->
-  <target name="javacc" depends="init,javacc-check" if="javacc.present">
+  <target name="javacc" depends="javacc-flexible,javacc-precedence"/>
+
+  <target name="javacc-flexible" depends="init,javacc-check" if="javacc.present">
     <invoke-javacc target="src/java/org/apache/lucene/queryParser/standard/parser/StandardSyntaxParser.jj"
                    outputDir="src/java/org/apache/lucene/queryParser/standard/parser"
     />
@@ -86,5 +88,17 @@
   	                         flags="g"
   	                         byline="false"/>
   </target>
+  
+  <property name="javacc.precedence.path" location="src/java/org/apache/lucene/queryParser/precedence"/>
 
+  <target name="javacc-precedence" depends="javacc-check" description="generate precedence query parser from jj (requires javacc 3.2)">
+    <delete>
+      <fileset dir="${javacc.precedence.path}" includes="*.java">
+        <containsregexp expression="Generated.*By.*JavaCC"/>
+      </fileset>
+    </delete>
+    <invoke-javacc target="${javacc.precedence.path}/PrecedenceQueryParser.jj"
+                   outputDir="${javacc.precedence.path}"
+    />
+  </target>
 </project>
Index: lucene/src/site/src/documentation/content/xdocs/site.xml
===================================================================
--- lucene/src/site/src/documentation/content/xdocs/site.xml	(revision 924892)
+++ lucene/src/site/src/documentation/content/xdocs/site.xml	(working copy)
@@ -58,7 +58,6 @@
 		    <javadoc-contrib-bdb label="Bdb" href="ext:javadocs-contrib-bdb"/>
 		    <javadoc-contrib-bdb-je label="Bdb-je" href="ext:javadocs-contrib-bdb-je"/>
 		    <javadoc-contrib-benchmark label="Benchmark" href="ext:javadocs-contrib-benchmark"/>
-		    <javadoc-contrib-fast-vector-highlighter label="Fast Vector Highlighter" href="ext:javadocs-contrib-fast-vector-highlighter"/>
 		    <javadoc-contrib-highlighter label="Highlighter" href="ext:javadocs-contrib-highlighter"/>
 		    <javadoc-contrib-icu label="ICU" href="ext:javadocs-contrib-icu"/>
 		    <javadoc-contrib-instantiated label="Instantiated" href="ext:javadocs-contrib-instantiated"/>
@@ -67,7 +66,6 @@
 		    <javadoc-contrib-misc label="Miscellaneous" href="ext:javadocs-contrib-misc"/>
 		    <javadoc-contrib-queries label="Queries" href="ext:javadocs-contrib-queries"/>
                     <javadoc-contrib-queryparser label="Query Parser Framework" href="ext:javadocs-contrib-queryparser"/>
-		    <javadoc-contrib-regex label="Regex" href="ext:javadocs-contrib-regex"/>
 <!-- This package has currently no content			
 		    <javadoc-contrib-similarity label="Similarity" href="ext:javadocs-contrib-similarity"/>
 -->			
@@ -112,7 +110,6 @@
 	<javadocs-contrib-bdb href="api/contrib-bdb/index.html"/>
 	<javadocs-contrib-bdb-je href="api/contrib-bdb-je/index.html"/>
 	<javadocs-contrib-benchmark href="api/contrib-benchmark/index.html"/>
-	<javadocs-contrib-fast-vector-highlighter href="api/contrib-fast-vector-highlighter/index.html"/>
 	<javadocs-contrib-highlighter href="api/contrib-highlighter/index.html"/>
     <javadocs-contrib-icu href="api/contrib-icu/index.html"/>
 	<javadocs-contrib-instantiated href="api/contrib-instantiated/index.html"/>
@@ -121,7 +118,6 @@
 	<javadocs-contrib-misc href="api/contrib-misc/index.html"/>
 	<javadocs-contrib-queries href="api/contrib-queries/index.html"/>
         <javadocs-contrib-queryparser href="api/contrib-queryparser/index.html"/>
-	<javadocs-contrib-regex href="api/contrib-regex/index.html"/>
 	<javadocs-contrib-remote href="api/contrib-remote/index.html"/>
 	<javadocs-contrib-similarity href="api/contrib-similarity/index.html"/>
 	<javadocs-contrib-spatial href="api/contrib-spatial/index.html"/>
Index: lucene/src/site/src/documentation/content/xdocs/lucene-contrib/index.xml
===================================================================
--- lucene/src/site/src/documentation/content/xdocs/lucene-contrib/index.xml	(revision 924892)
+++ lucene/src/site/src/documentation/content/xdocs/lucene-contrib/index.xml	(working copy)
@@ -74,12 +74,6 @@
                 <p>A set of classes for highlighting matching terms in search results.</p>
                 <p>See <a href="../api/contrib-highlighter/index.html">highlighter javadoc</a></p>
             </section>
-            
-            <section id="fast-vector-highlighter"><title>fast-vector-highlighter</title>
-                <p>An alternative set of classes for highlighting matching terms in search results that relies on stored term vectors.
-                This highlighter can be much faster than the standard highlighter, especially on large fields.</p>
-                <p>See <a href="../api/contrib-fast-vector-highlighter/index.html">fast-vector-highlighter javadoc</a></p>
-            </section>
 
             <section id="icu"><title>icu</title>
                 <p>Provides integration with ICU (International Components for Unicode) for
@@ -112,9 +106,9 @@
                 <p>See <a href="../api/contrib-queryparser/index.html">queryparser javadoc</a></p>
             </section>                          
  
-            <section id="regex"><title>regex</title>
-                <p>Queries with additional regex matching capabilities.</p>
-                <p>See <a href="../api/contrib-regex/index.html">regex javadoc</a></p>
+            <section id="queries"><title>queries</title>
+                <p>Additional queries for Lucene.</p>
+                <p>See <a href="../api/contrib-queries/index.html">queries javadoc</a></p>
             </section> 
             
             <section id="remote"><title>remote</title>
Index: solr/build.xml
===================================================================
--- solr/build.xml	(revision 924892)
+++ solr/build.xml	(working copy)
@@ -119,7 +119,6 @@
   <path id="lucene.classpath">
     <pathelement location="../lucene/build/classes/java" />
     <pathelement location="../lucene/build/contrib/analyzers/common/classes/java" />
-    <pathelement location="../lucene/build/contrib/fast-vector-highlighter/classes/java" />
     <pathelement location="../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="../lucene/build/contrib/memory/classes/java" />
     <pathelement location="../lucene/build/contrib/misc/classes/java" />
@@ -657,7 +656,6 @@
       </subant>
       <subant target="jar" inheritall="false" failonerror="true">
         <fileset dir="../lucene/contrib/analyzers/common" includes="build.xml" />
-        <fileset dir="../lucene/contrib/fast-vector-highlighter" includes="build.xml" />
         <fileset dir="../lucene/contrib/highlighter" includes="build.xml" />
         <fileset dir="../lucene/contrib/memory" includes="build.xml" />
         <fileset dir="../lucene/contrib/misc" includes="build.xml" />
@@ -674,7 +672,6 @@
       <resources>
         <file file="../lucene/build/lucene-core-${lucene_version}.jar" />
         <file file="../lucene/build/contrib/analyzers/common/lucene-analyzers-${lucene_version}.jar" />
-        <file file="../lucene/build/contrib/fast-vector-highlighter/lucene-fast-vector-highlighter-${lucene_version}.jar" />
         <file file="../lucene/build/contrib/highlighter/lucene-highlighter-${lucene_version}.jar" />
         <file file="../lucene/build/contrib/memory/lucene-memory-${lucene_version}.jar" />
         <file file="../lucene/build/contrib/misc/lucene-misc-${lucene_version}.jar" />
@@ -688,7 +685,6 @@
   <target name="compile-lucene">
     <ant antfile="build.xml" target="compile" dir="../lucene"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/analyzers/common"/>
-    <ant antfile="build.xml" target="compile" dir="../lucene/contrib/fast-vector-highlighter"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/highlighter"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/memory"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/misc"/>
Index: solr/contrib/clustering/build.xml
===================================================================
--- solr/contrib/clustering/build.xml	(revision 924892)
+++ solr/contrib/clustering/build.xml	(working copy)
@@ -33,7 +33,6 @@
   <path id="lucene.classpath">
     <pathelement location="../../../lucene/build/classes/java" />
     <pathelement location="../../../lucene/build/contrib/analyzers/common/classes/java" />
-    <pathelement location="../../../lucene/build/contrib/fast-vector-highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/memory/classes/java" />
     <pathelement location="../../../lucene/build/contrib/misc/classes/java" />
Index: solr/contrib/dataimporthandler/build.xml
===================================================================
--- solr/contrib/dataimporthandler/build.xml	(revision 924892)
+++ solr/contrib/dataimporthandler/build.xml	(working copy)
@@ -27,7 +27,6 @@
   <path id="lucene.classpath">
     <pathelement location="../../../lucene/build/classes/java" />
     <pathelement location="../../../lucene/build/contrib/analyzers/common/classes/java" />
-    <pathelement location="../../../lucene/build/contrib/fast-vector-highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/memory/classes/java" />
     <pathelement location="../../../lucene/build/contrib/misc/classes/java" />
Index: solr/contrib/extraction/build.xml
===================================================================
--- solr/contrib/extraction/build.xml	(revision 924892)
+++ solr/contrib/extraction/build.xml	(working copy)
@@ -28,7 +28,6 @@
   <path id="lucene.classpath">
     <pathelement location="../../../lucene/build/classes/java" />
     <pathelement location="../../../lucene/build/contrib/analyzers/common/classes/java" />
-    <pathelement location="../../../lucene/build/contrib/fast-vector-highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/memory/classes/java" />
     <pathelement location="../../../lucene/build/contrib/misc/classes/java" />
Index: solr/contrib/velocity/build.xml
===================================================================
--- solr/contrib/velocity/build.xml	(revision 924892)
+++ solr/contrib/velocity/build.xml	(working copy)
@@ -26,7 +26,6 @@
   <path id="lucene.classpath">
     <pathelement location="../../../lucene/build/classes/java" />
     <pathelement location="../../../lucene/build/contrib/analyzers/common/classes/java" />
-    <pathelement location="../../../lucene/build/contrib/fast-vector-highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="../../../lucene/build/contrib/memory/classes/java" />
     <pathelement location="../../../lucene/build/contrib/misc/classes/java" />
