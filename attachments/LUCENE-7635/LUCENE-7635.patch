diff --git a/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java b/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
index bf2ef57..250d7ca9 100644
--- a/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
+++ b/lucene/analysis/kuromoji/src/java/org/apache/lucene/analysis/ja/dict/UserDictionary.java
@@ -64,13 +64,11 @@ public final class UserDictionary implements Dictionary {
 
     // text, segmentation, readings, POS
     while ((line = br.readLine()) != null) {
-      // Remove comments
-      line = line.replaceAll("#.*$", "");
-
       // Skip empty lines or comment lines
-      if (line.trim().length() == 0) {
+      if(line.trim().length() == 0 || line.charAt(0) == '#') {
         continue;
       }
+
       String[] values = CSVUtil.parse(line);
       featureEntries.add(values);
     }
diff --git a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/dict/UserDictionaryTest.java b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/dict/UserDictionaryTest.java
index 88a366f..9e51d7e 100644
--- a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/dict/UserDictionaryTest.java
+++ b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/dict/UserDictionaryTest.java
@@ -71,7 +71,19 @@ public class UserDictionaryTest extends LuceneTestCase {
     int wordIdKeizai = result[1][0]; // wordId of 経済 in 日本経済新聞
     assertEquals("カスタム名詞", dictionary.getPartOfSpeech(wordIdKeizai));
   }
-  
+
+  @Test
+  public void testSharp() throws IOException {
+    String[] inputs = {"#withsharp", "withsharp#"};
+    UserDictionary dictionary = TestJapaneseTokenizer.readDict();
+
+    for (String input: inputs) {
+      int[][] result = dictionary.lookup("withsharp#".toCharArray(), 0, 10);
+      assertEquals(1, result.length);
+      assertEquals("カスタム名詞", dictionary.getPartOfSpeech(result[0][0]));
+    }
+  }
+
   @Test
   public void testRead() throws IOException {
     UserDictionary dictionary = TestJapaneseTokenizer.readDict();
diff --git a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
index f9db02c..d5f9f8e 100644
--- a/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
+++ b/lucene/analysis/kuromoji/src/test/org/apache/lucene/analysis/ja/userdict.txt
@@ -8,3 +8,7 @@
 # Silly entry:
 abcd,a b cd,foo1 foo2 foo3,bar
 abcdefg,ab cd efg,foo1 foo2 foo4,bar
+
+# For comment test
+withsharp#,withsharp#,withsharp#,カスタム名詞
+"#withsharp","#withsharp","#withsharp",カスタム名詞
