diff --git a/lucene/core/src/java/org/apache/lucene/index/ConcurrentMergeScheduler.java b/lucene/core/src/java/org/apache/lucene/index/ConcurrentMergeScheduler.java
index eef146aaf7..cdfec39c70 100644
--- a/lucene/core/src/java/org/apache/lucene/index/ConcurrentMergeScheduler.java
+++ b/lucene/core/src/java/org/apache/lucene/index/ConcurrentMergeScheduler.java
@@ -655,6 +655,8 @@ public class ConcurrentMergeScheduler extends MergeScheduler {
     @Override
     public void run() {
       try {
+        System.out.println("merge await");
+        mergeLatch.await();
         if (verbose()) {
           message("  merge thread: start");
         }
diff --git a/lucene/core/src/java/org/apache/lucene/index/MergeScheduler.java b/lucene/core/src/java/org/apache/lucene/index/MergeScheduler.java
index 66d0870608..c8348dc1bc 100644
--- a/lucene/core/src/java/org/apache/lucene/index/MergeScheduler.java
+++ b/lucene/core/src/java/org/apache/lucene/index/MergeScheduler.java
@@ -19,6 +19,7 @@ package org.apache.lucene.index;
 
 import java.io.Closeable;
 import java.io.IOException;
+import java.util.concurrent.CountDownLatch;
 
 import org.apache.lucene.index.MergePolicy.OneMerge;
 import org.apache.lucene.store.Directory;
@@ -33,6 +34,8 @@ import org.apache.lucene.util.InfoStream;
 */
 public abstract class MergeScheduler implements Closeable {
 
+  final CountDownLatch mergeLatch = new CountDownLatch(1);
+
   /** Sole constructor. (For invocation by subclass 
    *  constructors, typically implicit.) */
   protected MergeScheduler() {
diff --git a/lucene/core/src/java/org/apache/lucene/index/SegmentInfos.java b/lucene/core/src/java/org/apache/lucene/index/SegmentInfos.java
index 5697eed3cd..4032884534 100644
--- a/lucene/core/src/java/org/apache/lucene/index/SegmentInfos.java
+++ b/lucene/core/src/java/org/apache/lucene/index/SegmentInfos.java
@@ -33,6 +33,7 @@ import java.util.List;
 import java.util.Map.Entry;
 import java.util.Map;
 import java.util.Set;
+import java.util.concurrent.CountDownLatch;
 
 import org.apache.lucene.codecs.Codec;
 import org.apache.lucene.codecs.CodecUtil;
@@ -160,6 +161,9 @@ public final class SegmentInfos implements Cloneable, Iterable<SegmentCommitInfo
   /** The Lucene version major that was used to create the index. */
   private final int indexCreatedVersionMajor;
 
+  final CountDownLatch step1Latch = new CountDownLatch(1);
+  final CountDownLatch step2Latch = new CountDownLatch(1);
+
   /** Sole constructor.
    *  @param indexCreatedVersionMajor the Lucene version major at index creation time, or 6 if the index was created before 7.0 */
   public SegmentInfos(int indexCreatedVersionMajor) {
@@ -918,9 +922,17 @@ public final class SegmentInfos implements Cloneable, Iterable<SegmentCommitInfo
       }
     }
 
+    try {
+      System.out.println("segment notify");
+      step1Latch.countDown();
+      System.out.println("segment await");
+      step2Latch.await();
+    } catch (Exception e) {
+      throw new AssertionError(e);
+    }
     // the rest of the segments in list are duplicates, so don't remove from map, only list!
     segments.subList(newSegIdx, segments.size()).clear();
-    
+
     // Either we found place to insert segment, or, we did
     // not, but only because all segments we merged becamee
     // deleted while we are merging, in which case it should
diff --git a/lucene/core/src/test/org/apache/lucene/index/TestIndexWriter.java b/lucene/core/src/test/org/apache/lucene/index/TestIndexWriter.java
index 8e6de4703e..f13443a112 100644
--- a/lucene/core/src/test/org/apache/lucene/index/TestIndexWriter.java
+++ b/lucene/core/src/test/org/apache/lucene/index/TestIndexWriter.java
@@ -3076,7 +3076,7 @@ public class TestIndexWriter extends LuceneTestCase {
     }
   }
 
-  public void testSoftUpdateDocuments() throws IOException {
+  public void testSoftUpdateDocuments() throws Exception {
     Directory dir = newDirectory();
     IndexWriter writer = new IndexWriter(dir, newIndexWriterConfig().setSoftDeletesField("soft_delete"));
     expectThrows(IllegalArgumentException.class, () -> {
@@ -3138,10 +3138,20 @@ public class TestIndexWriter extends LuceneTestCase {
     searcher = new IndexSearcher(reader);
     topDocs = searcher.search(new TermQuery(new Term("id", "1")), 10);
     assertEquals(0, topDocs.totalHits);
+
+    // trigger merge here
+    MergeScheduler cms = writer.getConfig().mergeScheduler;
+    System.out.println("trigger merges");
+    cms.mergeLatch.countDown();
+
     int numSoftDeleted = 0;
+    System.out.println("test await");
+    writer.segmentInfos.step1Latch.await();
     for (SegmentCommitInfo info : writer.segmentInfos) {
-     numSoftDeleted += info.getSoftDelCount();
+      numSoftDeleted += info.getSoftDelCount();
     }
+    System.out.println("test notify");
+    writer.segmentInfos.step2Latch.countDown();
     assertEquals(writer.maxDoc() - writer.numDocs(), numSoftDeleted);
     writer.close();
     reader.close();
