 build.xml                     | 7 +++++++
 lucene/tools/build.xml        | 3 +++
 solr/test-framework/build.xml | 5 +----
 3 files changed, 11 insertions(+), 4 deletions(-)

diff --git a/build.xml b/build.xml
index 0036052..a5f09e4 100755
--- a/build.xml
+++ b/build.xml
@@ -524,14 +524,21 @@ File | Project Structure | Platform Settings | SDKs):
     <fileset dir="." id="clover.test.result.files">
       <include name="*/build/**/test/TEST-*.xml"/>
     </fileset>
+    <fileset dir="." id="clover.test.src.files">
+      <include name="**/src/test/**/*.java"/>
+      <!-- test framework source files are all test code: -->
+      <include name="*/test-framework/src/**/*.java"/>
+    </fileset>
     <clover-report projectName="Apache Lucene/Solr">
       <current outfile="${clover.report.dir}" title="Apache Lucene/Solr ${version}" numThreads="0">
         <format type="html" filter="assert"/>
         <testresults refid="clover.test.result.files"/>
+        <testsources refid="clover.test.src.files"/>
       </current>
       <current outfile="${clover.report.dir}/clover.xml" title="Apache Lucene/Solr ${version}">
         <format type="xml" filter="assert"/>
         <testresults refid="clover.test.result.files"/>
+        <testsources refid="clover.test.src.files"/>
       </current>
     </clover-report>
     <echo>You can find the merged Lucene/Solr Clover report in '${clover.report.dir}'.</echo>
diff --git a/lucene/tools/build.xml b/lucene/tools/build.xml
index 4f4ed51..4736ea5 100644
--- a/lucene/tools/build.xml
+++ b/lucene/tools/build.xml
@@ -40,6 +40,9 @@
   <target name="-check-forbidden-tests"/>
   <target name="-check-forbidden-sysout"/>
 
+  <!-- disable clover -->
+  <target name="-clover.setup" if="run.clover"/>
+
   <!--  
       Specialize compile-core to not depend on clover, to exclude a 
       classpath reference when compiling, and to not attempt to copy
diff --git a/solr/test-framework/build.xml b/solr/test-framework/build.xml
index baea996..1e275f2 100644
--- a/solr/test-framework/build.xml
+++ b/solr/test-framework/build.xml
@@ -37,7 +37,7 @@
     </ant>
   </target>
 
-  <target name="compile-core" depends="resolve, compile-solr-core, compile-test-framework">
+  <target name="compile-core" depends="resolve, clover, compile-solr-core, compile-test-framework">
     <!-- TODO: why does test-framework override compile-core to use this special classpath? -->
     <compile srcdir="${src.dir}" destdir="${build.dir}/classes/java">
       <classpath refid="test.base.classpath"/>
@@ -49,9 +49,6 @@
     </copy>
   </target>
 
-  <!-- redefine the clover setup, because we dont want to run clover for the test-framework -->
-  <target name="-clover.setup" if="run.clover"/>
-  
   <!-- redefine the forbidden apis for tests, as we check ourselves -->
   <target name="-check-forbidden-tests" depends="-init-forbidden-apis,compile-core">
     <forbidden-apis suppressAnnotation="**.SuppressForbidden" signaturesFile="${common.dir}/tools/forbiddenApis/tests.txt" classpathref="forbidden-apis.allclasses.classpath"> 
