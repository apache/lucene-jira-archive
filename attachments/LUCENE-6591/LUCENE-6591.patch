Index: lucene/core/src/java/org/apache/lucene/store/DataOutput.java
===================================================================
--- lucene/core/src/java/org/apache/lucene/store/DataOutput.java	(revision 1686442)
+++ lucene/core/src/java/org/apache/lucene/store/DataOutput.java	(working copy)
@@ -221,12 +221,14 @@
    * @see DataInput#readVLong()
    */
   public final void writeVLong(long i) throws IOException {
-    assert i >= 0L;
-    writeNegativeVLong(i);
+    if (i < 0) {
+      throw new IllegalArgumentException("cannot write negative vLong (got: " + i + ")");
+    }
+    writePossiblyNegativeVLong(i);
   }
 
-  // write a pontentially negative vLong
-  private void writeNegativeVLong(long i) throws IOException {
+  // write a potentially negative vLong
+  private void writePossiblyNegativeVLong(long i) throws IOException {
     while ((i & ~0x7FL) != 0L) {
       writeByte((byte)((i & 0x7FL) | 0x80L));
       i >>>= 7;
@@ -241,7 +243,7 @@
    * @see DataInput#readZLong()
    */
   public final void writeZLong(long i) throws IOException {
-    writeNegativeVLong(BitUtil.zigZagEncode(i));
+    writePossiblyNegativeVLong(BitUtil.zigZagEncode(i));
   }
 
   /** Writes a string.
