Index: solr/contrib/extraction/lib/commons-compress-NOTICE.txt
===================================================================
--- solr/contrib/extraction/lib/commons-compress-NOTICE.txt	(revision 1174080)
+++ solr/contrib/extraction/lib/commons-compress-NOTICE.txt	(working copy)
@@ -1,5 +1,5 @@
 Apache Commons Compress
-Copyright 2002-2010 The Apache Software Foundation
+Copyright 2002-2011 The Apache Software Foundation
 
 This product includes software developed by
 The Apache Software Foundation (http://www.apache.org/).
Index: solr/contrib/extraction/lib/commons-compress-1.1.jar
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: solr/contrib/extraction/lib/commons-compress-1.2.jar
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream

Property changes on: solr/contrib/extraction/lib/commons-compress-1.2.jar
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Index: modules/benchmark/lib/commons-compress-NOTICE.txt
===================================================================
--- modules/benchmark/lib/commons-compress-NOTICE.txt	(revision 1174080)
+++ modules/benchmark/lib/commons-compress-NOTICE.txt	(working copy)
@@ -1,5 +1,5 @@
 Apache Commons Compress
-Copyright 2002-2010 The Apache Software Foundation
+Copyright 2002-2011 The Apache Software Foundation
 
 This product includes software developed by
 The Apache Software Foundation (http://www.apache.org/).
Index: modules/benchmark/lib/commons-compress-1.1.jar
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream
Index: modules/benchmark/lib/commons-compress-1.2.jar
===================================================================
Cannot display: file marked as a binary type.
svn:mime-type = application/octet-stream

Property changes on: modules/benchmark/lib/commons-compress-1.2.jar
___________________________________________________________________
Added: svn:mime-type
   + application/octet-stream

Index: modules/benchmark/src/java/org/apache/lucene/benchmark/byTask/utils/StreamUtils.java
===================================================================
--- modules/benchmark/src/java/org/apache/lucene/benchmark/byTask/utils/StreamUtils.java	(revision 1174080)
+++ modules/benchmark/src/java/org/apache/lucene/benchmark/byTask/utils/StreamUtils.java	(working copy)
@@ -54,7 +54,7 @@
 		}
 		private InputStream inputStream(InputStream in) throws IOException {
 			try {
-				return csfType==null ? in : closableCompressorInputStream(this, in);
+				return csfType==null ? in : new CompressorStreamFactory().createCompressorInputStream(csfType, in);
 			} catch (CompressorException e) {
     		IOException ioe = new IOException(e.getMessage());
     		ioe.initCause(e);
@@ -80,7 +80,6 @@
     extensionToType.put(".gzip", Type.GZIP);
   }
   
-  
   /**
    * Returns an {@link InputStream} over the requested file. This method
    * attempts to identify the appropriate {@link InputStream} instance to return
@@ -106,32 +105,6 @@
 	}
   
   /**
-   * Wrap the compressor input stream so that calling close will also close
-   * the underlying stream - workaround for CommonsCompress bug (COMPRESS-127). 
-   */
-  private static InputStream closableCompressorInputStream(Type type, final InputStream is) throws CompressorException {
-    final InputStream delegee = new CompressorStreamFactory().createCompressorInputStream(type.csfType, is);
-    if (!Type.GZIP.equals(type)) {
-      return delegee; //compressor bug affects only gzip
-    }
-    return new InputStream() {
-			@Override	public int read() throws IOException { return delegee.read();	}
-			@Override	public int read(byte[] b) throws IOException { return delegee.read(b);	}
-			@Override	public int available() throws IOException {	return delegee.available();	}
-			@Override	public synchronized void mark(int readlimit) { delegee.mark(readlimit);	}
-			@Override	public boolean markSupported() { return delegee.markSupported(); }
-			@Override	public int read(byte[] b, int off, int len) throws IOException { return delegee.read(b, off, len); }
-			@Override	public synchronized void reset() throws IOException {	delegee.reset(); }
-			@Override	public long skip(long n) throws IOException {	return delegee.skip(n);	}
-			@Override	
-			public void close() throws IOException { 
-				delegee.close();
-				is.close();
-			}
-    };
-	}
-
-  /**
    * Returns an {@link OutputStream} over the requested file, identifying
    * the appropriate {@link OutputStream} instance similar to {@link #inputStream(File)}.
    */
Index: dev-tools/eclipse/dot.classpath
===================================================================
--- dev-tools/eclipse/dot.classpath	(revision 1174080)
+++ dev-tools/eclipse/dot.classpath	(working copy)
@@ -86,7 +86,7 @@
 	<classpathentry kind="lib" path="modules/analysis/morfologik/lib/morfologik-stemming-1.5.2.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-beanutils-1.7.0.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-collections-3.1.jar"/>
-	<classpathentry kind="lib" path="modules/benchmark/lib/commons-compress-1.1.jar"/>
+	<classpathentry kind="lib" path="modules/benchmark/lib/commons-compress-1.2.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-digester-1.7.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/commons-logging-1.0.4.jar"/>
 	<classpathentry kind="lib" path="modules/benchmark/lib/xercesImpl-2.9.1-patched-XERCESJ-1257.jar"/>
@@ -131,7 +131,7 @@
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/bcmail-jdk15-1.45.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/bcprov-jdk15-1.45.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/boilerpipe-1.1.0.jar"/>
-	<classpathentry kind="lib" path="solr/contrib/extraction/lib/commons-compress-1.1.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/extraction/lib/commons-compress-1.2.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/dom4j-1.6.1.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/fontbox-1.3.1.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/jempbox-1.3.1.jar"/>
Index: dev-tools/maven/pom.xml.template
===================================================================
--- dev-tools/maven/pom.xml.template	(revision 1174080)
+++ dev-tools/maven/pom.xml.template	(working copy)
@@ -213,7 +213,7 @@
       <dependency>
         <groupId>org.apache.commons</groupId>
         <artifactId>commons-compress</artifactId>
-        <version>1.1</version>
+        <version>1.2</version>
       </dependency>
       <dependency>
         <groupId>org.apache.solr</groupId>
