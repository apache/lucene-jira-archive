Index: lucene/test-framework/src/java/org/apache/lucene/store/MockIndexInputWrapper.java
===================================================================
--- lucene/test-framework/src/java/org/apache/lucene/store/MockIndexInputWrapper.java	(revision 1647378)
+++ lucene/test-framework/src/java/org/apache/lucene/store/MockIndexInputWrapper.java	(working copy)
@@ -1,5 +1,6 @@
 package org.apache.lucene.store;
 
+import java.io.Closeable;
 import java.io.IOException;
 import java.util.Map;
 import java.util.Set;
@@ -43,6 +44,9 @@
 
   @Override
   public void close() throws IOException {
+    // TODO turn on the following to look for leaks closing inputs,
+    // after fixing TestTransactions
+    // dir.maybeThrowDeterministicException();
     if (closed) {
       delegate.close(); // don't mask double-close bugs
       return;
@@ -49,12 +53,7 @@
     }
     closed = true;
     
-    try {
-      // turn on the following to look for leaks closing inputs,
-      // after fixing TestTransactions
-      // dir.maybeThrowDeterministicException();
-    } finally {
-      delegate.close();
+    try (Closeable delegate = this.delegate) {
       // Pending resolution on LUCENE-686 we may want to
       // remove the conditional check so we also track that
       // all clones get closed:
Index: lucene/test-framework/src/java/org/apache/lucene/store/MockIndexOutputWrapper.java
===================================================================
--- lucene/test-framework/src/java/org/apache/lucene/store/MockIndexOutputWrapper.java	(revision 1647378)
+++ lucene/test-framework/src/java/org/apache/lucene/store/MockIndexOutputWrapper.java	(working copy)
@@ -17,6 +17,7 @@
  * limitations under the License.
  */
 
+import java.io.Closeable;
 import java.io.IOException;
 
 import org.apache.lucene.util.LuceneTestCase;
@@ -98,10 +99,10 @@
     }
     closed = true;
     
-    try {
+    try (Closeable delegate = this.delegate) {
       dir.maybeThrowDeterministicException();
     } finally {
-      delegate.close();
+      dir.removeIndexOutput(this, name);
       if (dir.trackDiskUsage) {
         // Now compute actual disk usage & track the maxUsedSize
         // in the MockDirectoryWrapper:
@@ -110,7 +111,6 @@
           dir.maxUsedSize = size;
         }
       }
-      dir.removeIndexOutput(this, name);
     }
   }
   
