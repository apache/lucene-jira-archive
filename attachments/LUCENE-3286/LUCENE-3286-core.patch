Index: solr/build.xml
===================================================================
--- solr/build.xml	(revision 1162522)
+++ solr/build.xml	(working copy)
@@ -29,7 +29,7 @@
     <echo message="Use 'ant javadocs' to build javadocs under build/docs/api" />
     <echo message="Use 'ant generate-maven-artifacts' to generate maven artifacts." />
     <echo message="Use 'ant package' to generate zip, tgz for distribution." />
-    <echo message="Use 'ant luke' to start luke.  see: http://luke.googlecode.com" />
+    <!--<echo message="Use 'ant luke' to start luke.  see: http://luke.googlecode.com" />-->
     <echo message="Use 'ant test' to run unit tests." />
   </target>
 
@@ -87,10 +87,11 @@
   <target name="proxy.setup" if="proxy.specified">
     <setproxy proxyhost="${proxy.host}" proxyport="${proxy.port}" proxyuser="${proxy.user}" proxypassword="${proxy.password}"/>
   </target>
- 
 
+  <!--LUCENE-3286: Luke is incompatible with new XML QP location and target is not flexible
+  when it comes to incompatible changes.  Update when Luke has updated.
   <target name="compile-xml-query-parser">
-  	<ant dir="${common.dir}/contrib/xml-query-parser" target="compile-core" inheritAll="false">
+  	<ant dir="${common.dir}/../modules/queryparser" target="compile-core" inheritAll="false">
       <propertyset refid="uptodate.and.compiled.properties"/>
     </ant>
   </target>
@@ -104,7 +105,7 @@
   </target>
   <path id="luke.classpath">
     <pathelement location="${common.dir}/build/classes/java" />
-    <pathelement location="${common.dir}/build/contrib/xml-query-parser/classes/java" />
+    <pathelement location="${common.dir}/../modules/queryparser/build/classes/java" />
   </path>
   <target name="luke" depends="luke-download">
     <java fork="true"
@@ -120,7 +121,7 @@
         <path refid="test.classpath"/>
       </classpath>
     </java>
-  </target>
+  </target>-->
   
   <!-- ========================================================================= -->
   <!-- ========================== BUILD/TEST TASKS ============================= -->
Index: modules/queryparser/xmldtddocbuild.xml
===================================================================
--- modules/queryparser/xmldtddocbuild.xml	(revision 1162522)
+++ modules/queryparser/xmldtddocbuild.xml	(working copy)
@@ -43,7 +43,7 @@
                 sourceDir="."
                 destDir="docs"
                 docTitle = "Lucene XML Query syntax">
-                <include name="*.dtd"/>
+                <include name="org/apache/lucene/queryparser/xml/*.dtd"/>
         </DTDDoc>
 
     </target>
Index: modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeFilterBuilder.java
===================================================================
--- modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeFilterBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -25,7 +25,7 @@
 import org.apache.lucene.search.NumericRangeFilter;
 import org.apache.lucene.store.Directory;
 import org.apache.lucene.util.LuceneTestCase;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Document;
 import org.xml.sax.SAXException;
 
Index: modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeQueryBuilder.java
===================================================================
--- modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/test/org/apache/lucene/queryparser/xml/builders/TestNumericRangeQueryBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -20,7 +20,7 @@
 import org.apache.lucene.search.NumericRangeQuery;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.util.LuceneTestCase;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Document;
 import org.xml.sax.SAXException;
 
Index: modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestParser.java
===================================================================
--- modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestParser.java	(revision 0)
+++ modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestParser.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestQueryTemplateManager.java
===================================================================
--- modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestQueryTemplateManager.java	(revision 0)
+++ modules/queryparser/src/test/org/apache/lucene/queryparser/xml/TestQueryTemplateManager.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/DOMUtils.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilderFactory.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilderFactory.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilderFactory.java	(working copy)
@@ -1,7 +1,7 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.search.Filter;
 import org.w3c.dom.Element;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilderFactory.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilderFactory.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilderFactory.java	(working copy)
@@ -1,7 +1,7 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.search.Query;
 import org.w3c.dom.Element;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CoreParser.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CoreParser.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CoreParser.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.queryparser.classic.QueryParser;
+import org.apache.lucene.queryparser.xml.builders.*;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.builders.*;
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
 
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CorePlusExtensionsParser.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CorePlusExtensionsParser.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/CorePlusExtensionsParser.java	(working copy)
@@ -1,8 +1,9 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.queryparser.classic.QueryParser;
-import org.apache.lucene.xmlparser.builders.*;
+import org.apache.lucene.queryparser.xml.builders.*;
+
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
  * contributor license agreements.  See the NOTICE file distributed with
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanTermBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanTermBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanTermBuilder.java	(working copy)
@@ -1,10 +1,10 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.index.Term;
 import org.apache.lucene.search.spans.SpanQuery;
 import org.apache.lucene.search.spans.SpanTermQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanBuilderBase.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanBuilderBase.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanBuilderBase.java	(working copy)
@@ -1,7 +1,7 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermQueryBuilder.java	(working copy)
@@ -1,11 +1,11 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.index.Term;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.search.TermQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsFilterBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.analysis.TokenStream;
@@ -7,9 +7,9 @@
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.queries.TermsFilter;
 import org.apache.lucene.util.BytesRef;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 
 import java.io.IOException;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/RangeFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/RangeFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/RangeFilterBuilder.java	(working copy)
@@ -1,13 +1,13 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.search.TermRangeFilter;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/LikeThisQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/LikeThisQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/LikeThisQueryBuilder.java	(working copy)
@@ -1,7 +1,7 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import java.io.IOException;
 import java.io.StringReader;
@@ -12,10 +12,10 @@
 import org.apache.lucene.analysis.TokenStream;
 import org.apache.lucene.analysis.tokenattributes.CharTermAttribute;
 import org.apache.lucene.queries.mlt.MoreLikeThisQuery;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrBuilder.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.spans.SpanOrQuery;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
 
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeQueryBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -20,9 +20,9 @@
 import org.apache.lucene.search.NumericRangeQuery;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.util.NumericUtils;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 
 /**
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanQueryBuilder.java	(working copy)
@@ -1,14 +1,14 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.BooleanClause;
 import org.apache.lucene.search.BooleanQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
 import org.w3c.dom.NodeList;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNearBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNearBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNearBuilder.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.spans.SpanNearQuery;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
 
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanFirstBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanFirstBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanFirstBuilder.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.spans.SpanFirstQuery;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FuzzyLikeThisQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FuzzyLikeThisQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FuzzyLikeThisQueryBuilder.java	(working copy)
@@ -1,12 +1,12 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.analysis.Analyzer;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.apache.lucene.sandbox.queries.FuzzyLikeThisQuery;
 import org.apache.lucene.search.FuzzyQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
 import org.w3c.dom.Element;
 import org.w3c.dom.NodeList;
 
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingQueryBuilder.java	(working copy)
@@ -1,10 +1,10 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.queries.BoostingQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/ConstantScoreQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/ConstantScoreQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/ConstantScoreQueryBuilder.java	(working copy)
@@ -1,11 +1,11 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.ConstantScoreQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilderFactory;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilderFactory;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingTermBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingTermBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BoostingTermBuilder.java	(working copy)
@@ -1,11 +1,11 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.index.Term;
 import org.apache.lucene.search.payloads.AveragePayloadFunction;
 import org.apache.lucene.search.payloads.PayloadTermQuery;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 
 /**
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/CachedFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/CachedFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/CachedFilterBuilder.java	(working copy)
@@ -1,13 +1,13 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
+import org.apache.lucene.queryparser.xml.*;
 import org.apache.lucene.search.CachingWrapperFilter;
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.search.QueryWrapperFilter;
-import org.apache.lucene.xmlparser.*;
 import org.w3c.dom.Element;
 
 import java.util.Map;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrTermsBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrTermsBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanOrTermsBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.analysis.TokenStream;
@@ -8,8 +8,8 @@
 import org.apache.lucene.search.spans.SpanQuery;
 import org.apache.lucene.search.spans.SpanTermQuery;
 import org.apache.lucene.util.BytesRef;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 
 import java.io.IOException;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilderFactory.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilderFactory.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilderFactory.java	(working copy)
@@ -1,8 +1,8 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.Query;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 
 import java.util.HashMap;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/DuplicateFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/DuplicateFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/DuplicateFilterBuilder.java	(working copy)
@@ -1,13 +1,13 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.apache.lucene.sandbox.queries.DuplicateFilter;
 import org.apache.lucene.search.Filter;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
 import org.w3c.dom.Element;
 
 /**
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/TermsQueryBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.analysis.TokenStream;
@@ -9,9 +9,9 @@
 import org.apache.lucene.search.Query;
 import org.apache.lucene.search.TermQuery;
 import org.apache.lucene.util.BytesRef;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 
 import java.io.IOException;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNotBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNotBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanNotBuilder.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.spans.SpanNotQuery;
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/MatchAllDocsQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/MatchAllDocsQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/MatchAllDocsQueryBuilder.java	(working copy)
@@ -1,9 +1,9 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.MatchAllDocsQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FilteredQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FilteredQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/FilteredQueryBuilder.java	(working copy)
@@ -1,15 +1,15 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.search.FilteredQuery;
 import org.apache.lucene.search.Query;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 
 /**
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/UserInputQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/UserInputQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/UserInputQueryBuilder.java	(working copy)
@@ -1,13 +1,13 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.analysis.Analyzer;
 import org.apache.lucene.queryparser.classic.ParseException;
 import org.apache.lucene.queryparser.classic.QueryParser;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.util.Version;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 
 /**
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/NumericRangeFilterBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -22,9 +22,9 @@
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.search.NumericRangeFilter;
 import org.apache.lucene.util.NumericUtils;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 
 import java.io.IOException;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanFilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanFilterBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/BooleanFilterBuilder.java	(working copy)
@@ -1,15 +1,15 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 
 import org.apache.lucene.search.BooleanClause;
 import org.apache.lucene.queries.BooleanFilter;
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.queries.FilterClause;
-import org.apache.lucene.xmlparser.DOMUtils;
-import org.apache.lucene.xmlparser.FilterBuilder;
-import org.apache.lucene.xmlparser.ParserException;
+import org.apache.lucene.queryparser.xml.DOMUtils;
+import org.apache.lucene.queryparser.xml.FilterBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
 import org.w3c.dom.Element;
 import org.w3c.dom.Node;
 import org.w3c.dom.NodeList;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilder.java	(revision 1162522)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/builders/SpanQueryBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser.builders;
+package org.apache.lucene.queryparser.xml.builders;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
  * contributor license agreements.  See the NOTICE file distributed with
@@ -16,8 +16,8 @@
  * limitations under the License.
  */
 import org.apache.lucene.search.spans.SpanQuery;
-import org.apache.lucene.xmlparser.ParserException;
-import org.apache.lucene.xmlparser.QueryBuilder;
+import org.apache.lucene.queryparser.xml.ParserException;
+import org.apache.lucene.queryparser.xml.QueryBuilder;
 import org.w3c.dom.Element;
 
 public interface SpanQueryBuilder extends QueryBuilder {
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/ParserException.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/ParserException.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/ParserException.java	(working copy)
@@ -1,7 +1,7 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
  * contributor license agreements.  See the NOTICE file distributed with
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilder.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/FilterBuilder.java	(working copy)
@@ -1,7 +1,7 @@
 /*
  * Created on 25-Jan-2006
  */
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.search.Filter;
 import org.w3c.dom.Element;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilder.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilder.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryBuilder.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.apache.lucene.search.Query;
 import org.w3c.dom.Element;
Index: modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryTemplateManager.java
===================================================================
--- modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryTemplateManager.java	(revision 0)
+++ modules/queryparser/src/java/org/apache/lucene/queryparser/xml/QueryTemplateManager.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.xmlparser;
+package org.apache.lucene.queryparser.xml;
 
 import org.w3c.dom.Document;
 import org.w3c.dom.Element;
Index: modules/queryparser/build.xml
===================================================================
--- modules/queryparser/build.xml	(revision 1162522)
+++ modules/queryparser/build.xml	(working copy)
@@ -26,6 +26,14 @@
 
   <import file="../../lucene/contrib/contrib-build.xml"/>
 
+  <path id="classpath">
+    <pathelement path="${queries.jar}"/>
+    <pathelement path="${sandbox.jar}"/>
+    <path refid="base.classpath"/>
+  </path>
+
+  <target name="compile-core" depends="jar-queries,jar-sandbox,common.compile-core"/>
+
   <target name="dist-maven" depends="jar-core,javadocs,contrib-build.dist-maven"/>
 
   <target name="javacc" depends="init,javacc-check,javacc-QueryParser,javacc-surround,javacc-flexible"/>
Index: lucene/contrib/demo/src/java/org/apache/lucene/demo/xmlparser/FormBasedXmlQueryDemo.java
===================================================================
--- lucene/contrib/demo/src/java/org/apache/lucene/demo/xmlparser/FormBasedXmlQueryDemo.java	(revision 1162522)
+++ lucene/contrib/demo/src/java/org/apache/lucene/demo/xmlparser/FormBasedXmlQueryDemo.java	(working copy)
@@ -40,14 +40,14 @@
 import org.apache.lucene.index.CorruptIndexException;
 import org.apache.lucene.index.IndexWriter;
 import org.apache.lucene.index.IndexWriterConfig;
+import org.apache.lucene.queryparser.xml.CorePlusExtensionsParser;
+import org.apache.lucene.queryparser.xml.QueryTemplateManager;
 import org.apache.lucene.search.IndexSearcher;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.search.ScoreDoc;
 import org.apache.lucene.search.TopDocs;
 import org.apache.lucene.store.RAMDirectory;
 import org.apache.lucene.util.Version;
-import org.apache.lucene.xmlparser.CorePlusExtensionsParser;
-import org.apache.lucene.xmlparser.QueryTemplateManager;
 
 public class FormBasedXmlQueryDemo extends HttpServlet {
 
Index: lucene/contrib/demo/build.xml
===================================================================
--- lucene/contrib/demo/build.xml	(revision 1162522)
+++ lucene/contrib/demo/build.xml	(working copy)
@@ -33,11 +33,10 @@
 	 <pathelement path="${analyzers-common.jar}"/>
    <pathelement path="${queryparser.jar}"/>
    <pathelement path="${lucene-core.jar}"/>
-   <pathelement path="${xml-query-parser.jar}"/>
    <pathelement location="lib/servlet-api-2.4.jar"/>
   </path>
 
-  <target name="compile-core" depends="jar-analyzers-common,jar-queryparser,jar-xml-query-parser,common.compile-core" />
+  <target name="compile-core" depends="jar-analyzers-common,jar-queryparser,common.compile-core" />
 
   <target name="default" depends="jar-core,build-web-demo"/>
 
@@ -52,6 +51,7 @@
         <include name="${final.name}.jar"/>
       </lib>
       <lib file="${queries.jar}"/>
+      <lib file="${queryparser.jar}"/>
       <lib file="${lucene-core.jar}"/>
     </war>
   </target>
Index: lucene/contrib/contrib-build.xml
===================================================================
--- lucene/contrib/contrib-build.xml	(revision 1162522)
+++ lucene/contrib/contrib-build.xml	(working copy)
@@ -283,15 +283,4 @@
     </ant>
     <property name="suggest.uptodate" value="true"/>
   </target>
-
-  <property name="xml-query-parser.jar" value="${common.dir}/build/contrib/xml-query-parser/lucene-xml-query-parser-${version}.jar"/>
-  <target name="check-xml-query-parser-uptodate" unless="xml-query-parser.uptodate">
-    <contrib-uptodate name="xml-query-parser" jarfile="${xml-query-parser.jar}" property="xml-query-parser.uptodate"/>
-  </target>
-  <target name="jar-xml-query-parser" unless="xml-query-parser.uptodate" depends="check-xml-query-parser-uptodate">
-    <ant dir="${common.dir}/contrib/xml-query-parser" target="jar-core" inheritall="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="xml-query-parser.uptodate" value="true"/>
-  </target>
 </project>
Index: lucene/contrib/xml-query-parser/dtddocbuild.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/LuceneCoreQuery.dtd (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/README.htm (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/TermsQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/UserInputQueryCustomField.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/MatchAllDocsQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/UserInputQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/BooleanFilter.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/TermsFilterQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/SpanQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/RangeFilterQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/albumLuceneClassicQuery.xsl (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/NumericRangeQueryQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/albumBooleanQuery.xsl (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/TermQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/LikeThisQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/BoostingTermQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/BooleanQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/DuplicateFilterQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/NestedBooleanQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/FuzzyLikeThisQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/BoostingQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/builders/TestNumericRangeFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/builders/TestNumericRangeQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/NumericRangeFilterQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/ConstantScoreQuery.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/albumFilteredQuery.xsl (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/CachedFilter.xml (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/TestParser.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/TestQueryTemplateManager.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/test/org/apache/lucene/xmlparser/reuters21578.txt (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/DOMUtils.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/FilterBuilderFactory.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/QueryBuilderFactory.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/CoreParser.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/CorePlusExtensionsParser.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanTermBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanBuilderBase.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/TermQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/TermsFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/RangeFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/LikeThisQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanOrBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/NumericRangeQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/BooleanQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanNearBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanFirstBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/FuzzyLikeThisQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/BoostingQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/ConstantScoreQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/BoostingTermBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/CachedFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanOrTermsBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanQueryBuilderFactory.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/DuplicateFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/TermsQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanNotBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/MatchAllDocsQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/FilteredQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/UserInputQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/NumericRangeFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/BooleanFilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/SpanQueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/ParserException.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/FilterBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/QueryBuilder.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/QueryTemplateManager.java (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/package.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/src/java/overview.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneContribQuery.dtd.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/cctree.js (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneContribQuery.dtd.entities.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneContribQuery.dtd.org.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneCoreQuery.dtd.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/elementsIndex.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/toc.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/DTDDocStyle.css (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneCoreQuery.dtd.entities.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/index.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/dtreeStyle.css (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/minus.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/empty.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/join.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/minusbottom.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/plus.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/joinbottom.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/line.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/img/plusbottom.gif (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/LuceneCoreQuery.dtd.org.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/docs/intro.html (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/LuceneContribQuery.dtd (deleted)
===================================================================
Index: lucene/contrib/xml-query-parser/build.xml (deleted)
===================================================================
Index: lucene/build.xml
===================================================================
--- lucene/build.xml	(revision 1162522)
+++ lucene/build.xml	(working copy)
@@ -49,7 +49,7 @@
               excludes="*-src.jar"
   />
   <patternset id="binary.root.dist.patterns"
-              includes="CHANGES.txt,LICENSE.txt,NOTICE.txt,README.txt,MIGRATE.txt,JRE_VERSION_MIGRATION.txt,contrib/**/README*,**/CHANGES.txt,contrib/**/*.sh contrib/**/docs/ contrib/xml-query-parser/*.dtd,lib/*.jar,lib/*LICENSE*.txt,lib/*NOTICE*.txt,contrib/*/lib/*.jar,contrib/*/lib/*LICENSE*.txt,contrib/*/lib/*NOTICE*.txt"
+              includes="CHANGES.txt,LICENSE.txt,NOTICE.txt,README.txt,MIGRATE.txt,JRE_VERSION_MIGRATION.txt,contrib/**/README*,**/CHANGES.txt,contrib/**/*.sh contrib/**/docs/,lib/*.jar,lib/*LICENSE*.txt,lib/*NOTICE*.txt,contrib/*/lib/*.jar,contrib/*/lib/*LICENSE*.txt,contrib/*/lib/*NOTICE*.txt"
   />
 
 
@@ -257,7 +257,6 @@
           <packageset dir="contrib/misc/src/java"/>
           <packageset dir="contrib/sandbox/src/java"/>
           <packageset dir="contrib/spatial/src/java"/>
-          <packageset dir="contrib/xml-query-parser/src/java"/>
           <!-- end alpha sort -->
 
           <!-- If the main javadoc Group listing includes an "Other   -->
@@ -274,7 +273,6 @@
           <group title="contrib: Misc " packages="org.apache.lucene.misc*"/>
           <group title="contrib: Sandbox" packages="org.apache.lucene.sandbox*"/>
           <group title="contrib: Spatial" packages="org.apache.lucene.spatial*"/>
-          <group title="contrib: XML Query Parser" packages="org.apache.lucene.xmlparser*"/>
           
         </sources>
       </invoke-javadoc>
Index: dev-tools/idea/.idea/modules.xml
===================================================================
--- dev-tools/idea/.idea/modules.xml	(revision 1162522)
+++ dev-tools/idea/.idea/modules.xml	(working copy)
@@ -11,7 +11,6 @@
       <module filepath="$PROJECT_DIR$/lucene/contrib/misc/misc.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/spatial/spatial.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/sandbox/sandbox.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/contrib/xml-query-parser/xml-query-parser.iml" />
       <module filepath="$PROJECT_DIR$/modules/analysis/common/analysis-common.iml" />
       <module filepath="$PROJECT_DIR$/modules/analysis/icu/icu.iml" />
       <module filepath="$PROJECT_DIR$/modules/analysis/morfologik/morfologik.iml" />
Index: dev-tools/idea/.idea/workspace.xml
===================================================================
--- dev-tools/idea/.idea/workspace.xml	(revision 1162522)
+++ dev-tools/idea/.idea/workspace.xml	(working copy)
@@ -190,14 +190,7 @@
       <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=4.0 -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
     </configuration>
-    <configuration default="false" name="xml-query-parser contrib" type="JUnit" factoryName="JUnit">
-      <module name="xml-query-parser" />
-      <option name="TEST_OBJECT" value="package" />
-      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/lucene/build/contrib/xml-query-parser" />
-      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
-      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
-    </configuration>
-    <list size="28">
+    <list size="27">
       <item index="0" class="java.lang.String" itemvalue="JUnit.analysis-extras contrib" />
       <item index="1" class="java.lang.String" itemvalue="JUnit.benchmark module" />
       <item index="2" class="java.lang.String" itemvalue="JUnit.clustering contrib" />
@@ -225,7 +218,6 @@
       <item index="24" class="java.lang.String" itemvalue="JUnit.stempel analysis module" />
       <item index="25" class="java.lang.String" itemvalue="JUnit.suggest module" />
       <item index="26" class="java.lang.String" itemvalue="JUnit.uima contrib" />
-      <item index="27" class="java.lang.String" itemvalue="JUnit.xml-query-parser contrib" />
     </list>
   </component>
 </project>
Index: dev-tools/idea/modules/queryparser/queryparser.iml
===================================================================
--- dev-tools/idea/modules/queryparser/queryparser.iml	(revision 1162522)
+++ dev-tools/idea/modules/queryparser/queryparser.iml	(working copy)
@@ -14,5 +14,7 @@
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
     <orderEntry type="module" module-name="lucene" />
+    <orderEntry type="module" module-name="queries" />
+    <orderEntry type="module" module-name="sandbox" />
   </component>
 </module>
Index: dev-tools/idea/lucene/contrib/demo/demo.iml
===================================================================
--- dev-tools/idea/lucene/contrib/demo/demo.iml	(revision 1162522)
+++ dev-tools/idea/lucene/contrib/demo/demo.iml	(working copy)
@@ -22,7 +22,6 @@
       </library>
     </orderEntry>
     <orderEntry type="module" module-name="analysis-common" />
-    <orderEntry type="module" module-name="xml-query-parser" />
     <orderEntry type="module" module-name="lucene" />
     <orderEntry type="module" module-name="queryparser" />
   </component>
Index: dev-tools/idea/lucene/contrib/xml-query-parser/xml-query-parser.iml (deleted)
===================================================================
Index: dev-tools/eclipse/dot.classpath
===================================================================
--- dev-tools/eclipse/dot.classpath	(revision 1162522)
+++ dev-tools/eclipse/dot.classpath	(working copy)
@@ -18,8 +18,6 @@
 	<classpathentry kind="src" path="lucene/contrib/sandbox/src/test"/>
 	<classpathentry kind="src" path="lucene/contrib/spatial/src/java"/>
 	<classpathentry kind="src" path="lucene/contrib/spatial/src/test"/>
-	<classpathentry kind="src" path="lucene/contrib/xml-query-parser/src/java"/>
-	<classpathentry kind="src" path="lucene/contrib/xml-query-parser/src/test"/>
 	<classpathentry kind="src" path="modules/analysis/common/src/java"/>
 	<classpathentry kind="src" path="modules/analysis/common/src/resources"/>
 	<classpathentry kind="src" path="modules/analysis/common/src/test"/>
Index: dev-tools/maven/lucene/contrib/demo/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/demo/pom.xml.template	(revision 1162522)
+++ dev-tools/maven/lucene/contrib/demo/pom.xml.template	(working copy)
@@ -58,11 +58,6 @@
       <version>${project.version}</version>
     </dependency>
     <dependency>
-      <groupId>${project.groupId}</groupId>
-      <artifactId>lucene-xml-query-parser</artifactId>
-      <version>${project.version}</version>
-    </dependency>
-    <dependency>
       <groupId>javax.servlet</groupId>
       <artifactId>servlet-api</artifactId>
       <scope>provided</scope>
Index: dev-tools/maven/lucene/contrib/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/pom.xml.template	(revision 1162522)
+++ dev-tools/maven/lucene/contrib/pom.xml.template	(working copy)
@@ -38,7 +38,6 @@
     <module>misc</module>
     <module>sandbox</module>
     <module>spatial</module>
-    <module>xml-query-parser</module>
   </modules>
   <build>
     <directory>build/lucene-contrib-aggregator</directory>
Index: dev-tools/maven/lucene/contrib/xml-query-parser/pom.xml.template (deleted)
===================================================================
