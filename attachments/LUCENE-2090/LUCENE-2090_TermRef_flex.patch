Index: src/java/org/apache/lucene/index/TermRef.java
===================================================================
--- src/java/org/apache/lucene/index/TermRef.java	(revision 883786)
+++ src/java/org/apache/lucene/index/TermRef.java	(working copy)
@@ -102,19 +102,27 @@
     return other;
   }
 
-  public boolean startsWith(TermRef other) {
-    // nocommit: is this correct? Yes this is correct.
-    if (length < other.length) {
+  public boolean startsWith(TermRef other, int pos) {
+    // nocommit: maybe this one shouldn't be public...
+    if (pos < 0 || length - pos < other.length) {
       return false;
     }
     for(int i=0;i<other.length;i++) {
-      if (bytes[offset+i] != other.bytes[other.offset+i]) {
+      if (bytes[offset+pos+i] != other.bytes[other.offset+i]) {
         return false;
       }
     }
     return true;
   }
+  
+  public boolean startsWith(TermRef other) {
+    return startsWith(other, 0);
+  }
 
+  public boolean endsWith(TermRef other) {
+    return startsWith(other, length - other.length);   
+  }
+  
   @Override
   public int hashCode() {
     final int prime = 31;
