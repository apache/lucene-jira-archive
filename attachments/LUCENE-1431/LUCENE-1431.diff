--- src/java/org/apache/lucene/util/CloseableThreadLocal.java.orig	2008-10-30 09:29:16.000000000 +0100
+++ src/java/org/apache/lucene/util/CloseableThreadLocal.java	2008-10-30 10:02:57.000000000 +0100
@@ -53,7 +53,11 @@
   }
   
   public Object get() {
-    WeakReference weakRef = (WeakReference) t.get();
+    ThreadLocal tmp = t;
+    if (tmp == null) {
+      return null;
+    }
+    WeakReference weakRef = (WeakReference) tmp.get();
     if (weakRef == null) {
       Object iv = initialValue();
       if (iv != null) {
