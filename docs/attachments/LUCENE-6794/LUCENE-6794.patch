Index: lucene/test-framework/src/java/org/apache/lucene/util/TestSecurityManager.java
===================================================================
--- lucene/test-framework/src/java/org/apache/lucene/util/TestSecurityManager.java	(revision 1702119)
+++ lucene/test-framework/src/java/org/apache/lucene/util/TestSecurityManager.java	(working copy)
@@ -29,7 +29,9 @@
  */ 
 public final class TestSecurityManager extends SecurityManager {
   
-  static final String TEST_RUNNER_PACKAGE = "com.carrotsearch.ant.tasks.junit4.";
+  static final String JUNIT4_TEST_RUNNER_PACKAGE = "com.carrotsearch.ant.tasks.junit4.";
+  static final String ECLIPSE_TEST_RUNNER_PACKAGE = "org.eclipse.jdt.internal.junit.runner.";
+  static final String IDEA_TEST_RUNNER_PACKAGE = "com.intellij.rt.execution.junit.JUnitStarter.";
 
   /**
    * Creates a new TestSecurityManager. This ctor is called on JVM startup,
@@ -65,7 +67,9 @@
           }
           
           if (exitMethodHit != null) {
-            if (className.startsWith(TEST_RUNNER_PACKAGE)) {
+            if (className.startsWith(JUNIT4_TEST_RUNNER_PACKAGE) || 
+                className.startsWith(ECLIPSE_TEST_RUNNER_PACKAGE) ||
+                className.startsWith(IDEA_TEST_RUNNER_PACKAGE)) {
               // this exit point is allowed, we return normally from closure:
               return /*void*/ null;
             } else {
