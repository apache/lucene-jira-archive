Index: lucene/src/test/org/apache/lucene/util/TestByteBlockPool.java
===================================================================
--- lucene/src/test/org/apache/lucene/util/TestByteBlockPool.java	(revision 1228667)
+++ lucene/src/test/org/apache/lucene/util/TestByteBlockPool.java	(working copy)
@@ -1,5 +1,6 @@
 package org.apache.lucene.util;
 
+import java.io.EOFException;
 import java.io.IOException;
 import java.util.ArrayList;
 import java.util.List;
@@ -59,7 +60,7 @@
     try {
       input.readByte();
       fail("must be EOF");
-    } catch (IOException e) {
+    } catch (EOFException e) {
       // expected - read past EOF
     }
     dir.close();
Index: lucene/src/java/org/apache/lucene/store/NIOFSDirectory.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/NIOFSDirectory.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/NIOFSDirectory.java	(working copy)
@@ -182,7 +182,7 @@
       long pos = getFilePointer() + off;
       
       if (pos + len > end) {
-        throw new EOFException("read past EOF (resource: " + this + ")");
+        throw new EOFException("read past EOF: " + this);
       }
 
       try {
Index: lucene/src/java/org/apache/lucene/store/CompoundFileDirectory.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/CompoundFileDirectory.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/CompoundFileDirectory.java	(working copy)
@@ -216,7 +216,7 @@
     final String id = IndexFileNames.stripSegmentName(name);
     final FileEntry entry = entries.get(id);
     if (entry == null) {
-      throw new IOException("No sub-file with id " + id + " found (fileName=" + name + " files: " + entries.keySet() + ")");
+      throw new FileNotFoundException("No sub-file with id " + id + " found (fileName=" + name + " files: " + entries.keySet() + ")");
     }
     return handle.openSlice(name, entry.offset, entry.length);
   }
@@ -310,7 +310,7 @@
     final String id = IndexFileNames.stripSegmentName(name);
     final FileEntry entry = entries.get(id);
     if (entry == null) {
-      throw new IOException("No sub-file with id " + id + " found (fileName=" + name + " files: " + entries.keySet() + ")");
+      throw new FileNotFoundException("No sub-file with id " + id + " found (fileName=" + name + " files: " + entries.keySet() + ")");
     }
     return new IndexInputSlicer() {
       @Override
Index: lucene/src/java/org/apache/lucene/store/SimpleFSDirectory.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/SimpleFSDirectory.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/SimpleFSDirectory.java	(working copy)
@@ -17,6 +17,7 @@
  * limitations under the License.
  */
 
+import java.io.EOFException;
 import java.io.File;
 import java.io.IOException;
 import java.io.RandomAccessFile;
@@ -145,7 +146,7 @@
         int total = 0;
 
         if (position + len > end) {
-          throw new IOException("read past EOF: " + this);
+          throw new EOFException("read past EOF: " + this);
         }
 
         try {
Index: lucene/src/java/org/apache/lucene/store/DataInput.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/DataInput.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/DataInput.java	(working copy)
@@ -21,6 +21,8 @@
 import java.util.HashMap;
 import java.util.Map;
 
+import org.apache.lucene.util.IOUtils;
+
 /**
  * Abstract base class for performing read operations of Lucene's low-level
  * data types.
@@ -166,7 +168,7 @@
     int length = readVInt();
     final byte[] bytes = new byte[length];
     readBytes(bytes, 0, length);
-    return new String(bytes, 0, length, "UTF-8");
+    return new String(bytes, 0, length, IOUtils.CHARSET_UTF_8);
   }
 
   /** Returns a clone of this stream.
Index: lucene/src/java/org/apache/lucene/store/MMapDirectory.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/MMapDirectory.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/MMapDirectory.java	(working copy)
@@ -17,6 +17,7 @@
  * limitations under the License.
  */
  
+import java.io.EOFException;
 import java.io.IOException;
 import java.io.File;
 import java.io.RandomAccessFile;
@@ -303,7 +304,7 @@
         do {
           curBufIndex++;
           if (curBufIndex >= buffers.length) {
-            throw new IOException("read past EOF: " + this);
+            throw new EOFException("read past EOF: " + this);
           }
           curBuf = buffers[curBufIndex];
           curBuf.position(0);
@@ -326,7 +327,7 @@
           offset += curAvail;
           curBufIndex++;
           if (curBufIndex >= buffers.length) {
-            throw new IOException("read past EOF: " + this);
+            throw new EOFException("read past EOF: " + this);
           }
           curBuf = buffers[curBufIndex];
           curBuf.position(0);
@@ -394,12 +395,12 @@
         if (pos < 0L) {
           throw new IllegalArgumentException("Seeking to negative position: " + this);
         }
-        throw new IOException("seek past EOF");
+        throw new EOFException("seek past EOF: " + this);
       } catch (IllegalArgumentException iae) {
         if (pos < 0L) {
           throw new IllegalArgumentException("Seeking to negative position: " + this);
         }
-        throw new IOException("seek past EOF: " + this);
+        throw new EOFException("seek past EOF: " + this);
       } catch (NullPointerException npe) {
         throw new AlreadyClosedException("MMapIndexInput already closed: " + this);
       }
Index: lucene/src/java/org/apache/lucene/store/BufferedIndexInput.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/BufferedIndexInput.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/BufferedIndexInput.java	(working copy)
@@ -17,6 +17,7 @@
  * limitations under the License.
  */
 
+import java.io.EOFException;
 import java.io.IOException;
 
 /** Base implementation class for buffered {@link IndexInput}. */
@@ -138,7 +139,7 @@
         if(bufferLength<len){
           // Throw an exception when refill() could not read len bytes:
           System.arraycopy(buffer, 0, b, offset, bufferLength);
-          throw new IOException("read past EOF");
+          throw new EOFException("read past EOF: " + this);
         } else {
           System.arraycopy(buffer, 0, b, offset, len);
           bufferPosition=len;
@@ -153,7 +154,7 @@
         // had in the buffer.
         long after = bufferStart+bufferPosition+len;
         if(after > length())
-          throw new IOException("read past EOF");
+          throw new EOFException("read past EOF: " + this);
         readInternal(b, offset, len);
         bufferStart = after;
         bufferPosition = 0;
@@ -231,7 +232,7 @@
       end = length();
     int newLength = (int)(end - start);
     if (newLength <= 0)
-      throw new IOException("read past EOF");
+      throw new EOFException("read past EOF: " + this);
 
     if (buffer == null) {
       newBuffer(new byte[bufferSize]);  // allocate buffer lazily
Index: lucene/src/java/org/apache/lucene/store/Directory.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/Directory.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/Directory.java	(working copy)
@@ -17,6 +17,7 @@
  * limitations under the License.
  */
 
+import java.io.EOFException;
 import java.io.FileNotFoundException;
 import java.io.IOException;
 import java.io.Closeable;
@@ -305,7 +306,7 @@
     protected void readInternal(byte[] b, int offset, int len) throws IOException {
       long start = getFilePointer();
       if(start + len > length)
-        throw new IOException("read past EOF");
+        throw new EOFException("read past EOF: " + this);
       base.seek(fileOffset + start);
       base.readBytes(b, offset, len, false);
     }
@@ -338,7 +339,7 @@
       if (numBytes > 0) {
         long start = getFilePointer();
         if (start + numBytes > length) {
-          throw new IOException("read past EOF");
+          throw new EOFException("read past EOF: " + this);
         }
         base.seek(fileOffset + start);
         base.copyBytes(out, numBytes);
Index: lucene/src/java/org/apache/lucene/store/RAMInputStream.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/RAMInputStream.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/RAMInputStream.java	(working copy)
@@ -91,7 +91,7 @@
     if (currentBufferIndex >= file.numBuffers()) {
       // end of file reached, no more buffers left
       if (enforceEOF) {
-        throw new EOFException("Read past EOF (resource: " + this + ")");
+        throw new EOFException("read past EOF: " + this);
       } else {
         // Force EOF if a read takes place at this position
         currentBufferIndex--;
Index: lucene/src/java/org/apache/lucene/store/ByteArrayDataInput.java
===================================================================
--- lucene/src/java/org/apache/lucene/store/ByteArrayDataInput.java	(revision 1228667)
+++ lucene/src/java/org/apache/lucene/store/ByteArrayDataInput.java	(working copy)
@@ -100,11 +100,11 @@
 
   @Override
   public int readVInt() {
-    checkBounds();
+    assert checkBounds();
     byte b = bytes[pos++];
     int i = b & 0x7F;
     for (int shift = 7; (b & 0x80) != 0; shift += 7) {
-      checkBounds();
+      assert checkBounds();
       b = bytes[pos++];
       i |= (b & 0x7F) << shift;
     }
@@ -113,11 +113,11 @@
  
   @Override
   public long readVLong() {
-    checkBounds();
+    assert checkBounds();
     byte b = bytes[pos++];
     long i = b & 0x7F;
     for (int shift = 7; (b & 0x80) != 0; shift += 7) {
-      checkBounds();
+      assert checkBounds();
       b = bytes[pos++];
       i |= (b & 0x7FL) << shift;
     }
@@ -127,7 +127,7 @@
   // NOTE: AIOOBE not EOF if you read too much
   @Override
   public byte readByte() {
-    checkBounds();
+    assert checkBounds();
     return bytes[pos++];
   }
 
@@ -140,7 +140,6 @@
   }
 
   private boolean checkBounds() {
-    assert pos < limit;
-    return true;
+    return pos < limit;
   }
 }
Index: lucene/contrib/misc/src/java/org/apache/lucene/store/WindowsDirectory.java
===================================================================
--- lucene/contrib/misc/src/java/org/apache/lucene/store/WindowsDirectory.java	(revision 1228667)
+++ lucene/contrib/misc/src/java/org/apache/lucene/store/WindowsDirectory.java	(working copy)
@@ -97,7 +97,7 @@
       }
 
       if (bytesRead != length) {
-        throw new EOFException("Read past EOF (resource: " + this + ")");
+        throw new EOFException("read past EOF: " + this);
       }
     }
 
Index: lucene/contrib/misc/src/java/org/apache/lucene/store/DirectIOLinuxDirectory.java
===================================================================
--- lucene/contrib/misc/src/java/org/apache/lucene/store/DirectIOLinuxDirectory.java	(revision 1228667)
+++ lucene/contrib/misc/src/java/org/apache/lucene/store/DirectIOLinuxDirectory.java	(working copy)
@@ -17,6 +17,7 @@
  * the License.
  */
 
+import java.io.EOFException;
 import java.io.File;
 import java.io.IOException;
 import java.io.FileInputStream;
@@ -340,7 +341,7 @@
         throw new IOException(ioe.getMessage() + ": " + this, ioe);
       }
       if (n < 0) {
-        throw new IOException("eof: " + this);
+        throw new EOFException("read past EOF: " + this);
       }
       buffer.rewind();
     }
