Index: lucene/core/src/java/org/apache/lucene/analysis/CachingTokenFilter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
--- lucene/core/src/java/org/apache/lucene/analysis/CachingTokenFilter.java	(revision 1634894)
+++ lucene/core/src/java/org/apache/lucene/analysis/CachingTokenFilter.java	(revision )
@@ -18,8 +18,8 @@
  */
 
 import java.io.IOException;
+import java.util.ArrayList;
 import java.util.Iterator;
-import java.util.LinkedList;
 import java.util.List;
 
 import org.apache.lucene.util.AttributeSource;
@@ -51,7 +51,7 @@
   public final boolean incrementToken() throws IOException {
     if (cache == null) {
       // fill cache lazily
-      cache = new LinkedList<>();
+      cache = new ArrayList<>(64);
       fillCache();
       iterator = cache.iterator();
     }
@@ -93,6 +93,11 @@
     // capture final state
     input.end();
     finalState = captureState();
+  }
+
+  /** If the underlying token stream was consumed and cached */
+  public boolean isCached() {
+    return cache != null;
   }
 
 }
