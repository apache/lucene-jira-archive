Index: D:/programming/projects/componence/lucene-dev/src/java/org/apache/lucene/store/RAMDirectory.java
===================================================================
--- D:/programming/projects/componence/lucene-dev/src/java/org/apache/lucene/store/RAMDirectory.java	(revision 327185)
+++ D:/programming/projects/componence/lucene-dev/src/java/org/apache/lucene/store/RAMDirectory.java	(working copy)
@@ -33,6 +33,8 @@
 public final class RAMDirectory extends Directory {
   Hashtable files = new Hashtable();
 
+  private static int READ_BUFFER_SIZE = 1024;
+  
   /** Constructs an empty {@link Directory}. */
   public RAMDirectory() {
   }
@@ -60,9 +62,15 @@
       IndexInput is = dir.openInput(files[i]);
       // and copy to ram disk
       int len = (int) is.length();
-      byte[] buf = new byte[len];
-      is.readBytes(buf, 0, len);
-      os.writeBytes(buf, len);
+      int readCount = 0;
+      byte[] buf = new byte[READ_BUFFER_SIZE];
+      while (readCount < len) {
+        int toRead = readCount + READ_BUFFER_SIZE > len ? len - readCount : READ_BUFFER_SIZE;
+        is.readBytes(buf, 0, toRead);
+        os.writeBytes(buf, toRead);
+        readCount += toRead;
+      }
+
       // graceful cleanup
       is.close();
       os.close();
