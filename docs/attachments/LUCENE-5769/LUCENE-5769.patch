Index: lucene/core/src/java/org/apache/lucene/index/SingletonSortedSetDocValues.java
===================================================================
--- lucene/core/src/java/org/apache/lucene/index/SingletonSortedSetDocValues.java	(revision 1603009)
+++ lucene/core/src/java/org/apache/lucene/index/SingletonSortedSetDocValues.java	(working copy)
@@ -25,10 +25,10 @@
  * This can be used if you want to have one multi-valued implementation
  * that works for single or multi-valued types.
  */
-final class SingletonSortedSetDocValues extends SortedSetDocValues {
+final class SingletonSortedSetDocValues extends RandomAccessOrds {
   private final SortedDocValues in;
-  private int docID;
-  private boolean set;
+  private long currentOrd;
+  private long ord;
   
   /** Creates a multi-valued view over the provided SortedDocValues */
   public SingletonSortedSetDocValues(SortedDocValues in) {
@@ -43,18 +43,14 @@
 
   @Override
   public long nextOrd() {
-    if (set) {
-      return NO_MORE_ORDS;
-    } else {
-      set = true;
-      return in.getOrd(docID);
-    }
+    long v = currentOrd;
+    currentOrd = NO_MORE_ORDS;
+    return v;
   }
 
   @Override
   public void setDocument(int docID) {
-    this.docID = docID;
-    set = false;
+    currentOrd = ord = in.getOrd(docID);
   }
 
   @Override
@@ -72,4 +68,14 @@
   public long lookupTerm(BytesRef key) {
     return in.lookupTerm(key);
   }
+
+  @Override
+  public long ordAt(int index) {
+    return ord;
+  }
+
+  @Override
+  public int cardinality() {
+    return (int) (ord >>> 63) ^ 1;
+  }
 }
