Index: src/java/org/apache/lucene/index/DirectoryReader.java
===================================================================
--- src/java/org/apache/lucene/index/DirectoryReader.java	(revision 919119)
+++ src/java/org/apache/lucene/index/DirectoryReader.java	(working copy)
@@ -145,7 +145,7 @@
     for (int i=0;i<numSegments;i++) {
       boolean success = false;
       try {
-        final SegmentInfo info = infos.info(upto);
+        final SegmentInfo info = infos.info(i);
         if (info.dir == dir) {
           readers[upto++] = writer.readerPool.getReadOnlyClone(info, true, termInfosIndexDivisor);
         }
@@ -248,7 +248,7 @@
                 if (!readerShared[i]) {
                   // this is a new subReader that is not used by the old one,
                   // we can close it
-                  newReaders[i].close();
+                  newReaders[i].decRef();
                 } else {
                   // this subReader is also used by the old reader, so instead
                   // closing we must decRef it
Index: src/java/org/apache/lucene/index/IndexWriter.java
===================================================================
--- src/java/org/apache/lucene/index/IndexWriter.java	(revision 917203)
+++ src/java/org/apache/lucene/index/IndexWriter.java	(working copy)
@@ -477,7 +477,8 @@
 
       assert !pooled | readerMap.get(sr.getSegmentInfo()) == sr;
 
-      // Drop caller's ref
+      // Drop caller's ref; for an external reader (not
+      // pooled), this decRef will close it
       sr.decRef();
 
       if (pooled && (drop || (!poolReaders && sr.getRefCount() == 1))) {
@@ -613,7 +614,11 @@
         // synchronized
         // Returns a ref, which we xfer to readerMap:
         sr = SegmentReader.get(false, info.dir, info, readBufferSize, doOpenStores, termsIndexDivisor);
-        readerMap.put(info, sr);
+
+        if (info.dir == directory) {
+          // Only pool if reader is not external
+          readerMap.put(info, sr);
+        }
       } else {
         if (doOpenStores) {
           sr.openDocStores();
@@ -630,7 +635,10 @@
       }
 
       // Return a ref to our caller
-      sr.incRef();
+      if (info.dir == directory) {
+        // Only incRef if we pooledd (reader is not external)
+        sr.incRef();
+      }
       return sr;
     }
 
