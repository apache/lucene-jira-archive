Index: lucene/contrib/benchmark/build.xml
===================================================================
--- lucene/contrib/benchmark/build.xml	(revision 940980)
+++ lucene/contrib/benchmark/build.xml	(working copy)
@@ -14,7 +14,7 @@
     <contrib-uptodate name="highlighter" property="highlighter.uptodate" classpath.property="highlighter.jar"/>
     <contrib-uptodate name="icu" property="icu.uptodate" classpath.property="icu.jar"/>
     <!-- analyzers common needs a hack for the jar file: -->
-    <contrib-uptodate name="analyzers/common" jarfile="${common.dir}/build/contrib/analyzers/common/lucene-analyzers-${version}.jar"
+    <module-uptodate name="analysis/common" jarfile="${common.dir}/../modules/analysis/build/common/lucene-analyzers-common-${version}.jar"
       property="analyzers-common.uptodate" classpath.property="analyzers-common.jar"/>
     <contrib-uptodate name="memory" property="memory.uptodate" classpath.property="memory.jar"/>
 
@@ -244,7 +244,7 @@
     </target>
     <target name="compile-analyzers-common" unless="analyzers-common.uptodate">
       <subant target="default">
-        <fileset dir="${common.dir}/contrib/analyzers/common" includes="build.xml"/>
+        <fileset dir="${common.dir}/../modules/analysis/common" includes="build.xml"/>
       </subant>
     </target>
     <target name="compile-memory" unless="memory.uptodate">
Index: lucene/contrib/contrib-build.xml
===================================================================
--- lucene/contrib/contrib-build.xml	(revision 940980)
+++ lucene/contrib/contrib-build.xml	(working copy)
@@ -122,4 +122,18 @@
       </uptodate>
     </sequential>
   </macrodef>
+
+  <macrodef name="module-uptodate">
+    <attribute name="name"/>
+    <attribute name="property" default="@{name}.uptodate"/>
+    <attribute name="classpath.property" default="@{name}.jar"/>
+    <!-- set jarfile only, if the target jar file has no generic name, applies to analyzers with its common and smartcn subdir -->
+    <attribute name="jarfile" default="${common.dir}/../modules/@{name}/build/lucene-@{name}-${version}.jar"/>
+    <sequential>
+      <property name="@{classpath.property}" location="@{jarfile}"/>
+      <uptodate property="@{property}" targetfile="@{jarfile}">
+      	<srcfiles dir="${common.dir}/../modules/@{name}/src/java" includes="**/*.java"/>
+      </uptodate>
+    </sequential>
+  </macrodef>
 </project>

Property changes on: modules\analysis
___________________________________________________________________
Added: svn:ignore
   + build


Index: modules/analysis/common/build.xml
===================================================================
--- modules/analysis/common/build.xml	(revision 940980)
+++ modules/analysis/common/build.xml	(working copy)
@@ -17,21 +17,21 @@
     limitations under the License.
  -->
 
-<project name="analyzers" default="default">
+<project name="analyzers-common" default="default">
 
   <description>
-    Additional Analyzers
+   Analyzers
   </description>
 	
-  <property name="build.dir" location="../../../build/contrib/analyzers/common" />
-  <property name="dist.dir" location="../../../dist/contrib/analyzers/common" />
-  <property name="maven.dist.dir" location="../../../dist/maven" />
+  <property name="build.dir" location="../build/common" />
+  <property name="dist.dir" location="../dist/common" />
+  <property name="maven.dist.dir" location="../dist/maven" />
 
-  <import file="../../contrib-build.xml"/>
+  <import file="../../../lucene/contrib/contrib-build.xml"/>
 	
   <path id="test.classpath">
     <path refid="classpath"/>
-    <pathelement location="../../../build/classes/test/"/>
+    <pathelement location="../../../lucene/build/classes/test/"/>
     <path refid="junit-path"/>
     <pathelement location="${build.dir}/classes/java"/>
   </path>	
Index: modules/analysis/smartcn/build.xml
===================================================================
--- modules/analysis/smartcn/build.xml	(revision 940980)
+++ modules/analysis/smartcn/build.xml	(working copy)
@@ -17,19 +17,19 @@
     limitations under the License.
  -->
 
-<project name="smartcn" default="default">
+<project name="analyzers-smartcn" default="default">
 
   <description>
     Smart Chinese Analyzer
   </description>
 	
-  <property name="build.dir" location="../../../build/contrib/analyzers/smartcn" />
-  <property name="dist.dir" location="../../../dist/contrib/analyzers/smartcn" />
-  <property name="maven.dist.dir" location="../../../dist/maven" />
+  <property name="build.dir" location="../build/smartcn" />
+  <property name="dist.dir" location="../dist/smartcn" />
+  <property name="maven.dist.dir" location="../dist/maven" />
 
-  <import file="../../contrib-build.xml"/>
+  <import file="../../../lucene/contrib/contrib-build.xml"/>
 
-  <contrib-uptodate name="analyzers/common" jarfile="${common.dir}/build/contrib/analyzers/common/lucene-analyzers-${version}.jar"
+  <module-uptodate name="analysis/common" jarfile="../build/common/lucene-analyzers-common-${version}.jar"
     property="analyzers-common.uptodate" classpath.property="analyzers-common.jar"/>
 
   <path id="classpath">
@@ -40,7 +40,7 @@
   <path id="test.classpath">
   	<pathelement path="${analyzers-common.jar}"/>
     <path refid="classpath"/>
-    <pathelement location="../../../build/classes/test/"/>
+    <pathelement location="../../../lucene/build/classes/test/"/>
     <path refid="junit-path"/>
     <pathelement location="${build.dir}/classes/java"/>
   </path>
Index: modules/analysis/stempel/build.xml
===================================================================
--- modules/analysis/stempel/build.xml	(revision 940980)
+++ modules/analysis/stempel/build.xml	(working copy)
@@ -17,21 +17,21 @@
     limitations under the License.
  -->
 
-<project name="stempel" default="default">
+<project name="analyzers-stempel" default="default">
 
   <description>
     Stempel Analyzer
   </description>
 	
-  <property name="build.dir" location="../../../build/contrib/analyzers/stempel" />
-  <property name="dist.dir" location="../../../dist/contrib/analyzers/stempel" />
-  <property name="maven.dist.dir" location="../../../dist/maven" />
+  <property name="build.dir" location="../build/stempel" />
+  <property name="dist.dir" location="../dist/stempel" />
+  <property name="maven.dist.dir" location="../dist/maven" />
 
-  <import file="../../contrib-build.xml"/>
+  <import file="../../../lucene/contrib/contrib-build.xml"/>
 	
   <path id="test.classpath">
     <path refid="classpath"/>
-    <pathelement location="../../../build/classes/test/"/>
+    <pathelement location="../../../lucene/build/classes/test/"/>
     <path refid="junit-path"/>
     <pathelement location="${build.dir}/classes/java"/>
   </path>	
Index: modules/build.xml
===================================================================
--- modules/build.xml	(revision 0)
+++ modules/build.xml	(revision 0)
@@ -0,0 +1,45 @@
+<?xml version="1.0"?>
+
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+ 
+        http://www.apache.org/licenses/LICENSE-2.0
+ 
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+ -->
+
+<project name="modules" default="test" basedir=".">
+  <target name="test" description="Test all modules">
+    <sequential>
+      <subant target="test" inheritall="false" failonerror="true">
+        <fileset dir="analysis" includes="build.xml" />
+      </subant>
+    </sequential>
+  </target>
+
+  <target name="compile" description="Compile Lucene and Solr">
+    <sequential>
+      <subant target="compile" inheritall="false" failonerror="true">
+        <fileset dir="analysis" includes="build.xml" />
+      </subant>
+    </sequential>
+  </target>
+
+  <target name="clean" description="Clean Lucene and Solr">
+    <sequential>
+      <subant target="clean" inheritall="false" failonerror="true">
+        <fileset dir="analysis" includes="build.xml" />
+      </subant>
+    </sequential>
+  </target>
+
+</project>

Property changes on: modules\build.xml
___________________________________________________________________
Added: svn:eol-style
   + native

Index: solr/common-build.xml
===================================================================
--- solr/common-build.xml	(revision 940980)
+++ solr/common-build.xml	(working copy)
@@ -154,7 +154,7 @@
   
   <path id="lucene.classpath">
     <pathelement location="${common-solr.dir}/../lucene/build/classes/java" />
-    <pathelement location="${common-solr.dir}/../lucene/build/contrib/analyzers/common/classes/java" />
+    <pathelement location="${common-solr.dir}/../modules/analysis/build/common/classes/java" />
     <pathelement location="${common-solr.dir}/../lucene/build/contrib/highlighter/classes/java" />
     <pathelement location="${common-solr.dir}/../lucene/build/contrib/memory/classes/java" />
     <pathelement location="${common-solr.dir}/../lucene/build/contrib/misc/classes/java" />
@@ -169,7 +169,7 @@
         <fileset dir="../lucene/" includes="build.xml" />
       </subant>
       <subant target="jar" inheritall="false" failonerror="true">
-        <fileset dir="../lucene/contrib/analyzers/common" includes="build.xml" />
+        <fileset dir="../modules/analysis/common" includes="build.xml" />
         <fileset dir="../lucene/contrib/highlighter" includes="build.xml" />
         <fileset dir="../lucene/contrib/memory" includes="build.xml" />
         <fileset dir="../lucene/contrib/misc" includes="build.xml" />
@@ -186,8 +186,8 @@
       <fileset dir="../lucene/build/">
         <include name="lucene-core-${lucene_version}.jar" />
       </fileset>
-      <fileset dir="../lucene/build/contrib/analyzers/common">
-        <include name="lucene-analyzers-${lucene_version}.jar" />
+      <fileset dir="../modules/analysis/build/common">
+        <include name="lucene-analyzers-common-${lucene_version}.jar" />
       </fileset>
       <fileset dir="../lucene/build/contrib/highlighter">
         <include name="lucene-highlighter-${lucene_version}.jar" />
@@ -212,7 +212,7 @@
   
   <target name="compile-lucene" unless="lucene-compiled">
     <property name="lucene-compiled" value="true"/>
-    <ant antfile="build.xml" target="compile" dir="../lucene/contrib/analyzers/common"/>
+    <ant antfile="build.xml" target="compile" dir="../modules/analysis/common"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/highlighter"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/memory"/>
     <ant antfile="build.xml" target="compile" dir="../lucene/contrib/misc"/>
Index: build.xml
===================================================================
--- build.xml	(revision 940980)
+++ build.xml	(working copy)
@@ -25,6 +25,10 @@
       </subant>
 
       <subant target="test" inheritall="false" failonerror="true">
+        <fileset dir="modules" includes="build.xml" />
+      </subant>
+
+      <subant target="test" inheritall="false" failonerror="true">
         <fileset dir="solr" includes="build.xml" />
       </subant>
     </sequential>
@@ -34,6 +38,7 @@
     <sequential>
       <subant target="compile" inheritall="false" failonerror="true">
         <!--<fileset dir="lucene" includes="build.xml" /> -->
+        <fileset dir="modules" includes="build.xml" />
         <fileset dir="solr" includes="build.xml" />
       </subant>
     </sequential>
@@ -43,6 +48,7 @@
     <sequential>
       <subant target="clean" inheritall="false" failonerror="true">
         <fileset dir="lucene" includes="build.xml" />
+        <fileset dir="modules" includes="build.xml" />
         <fileset dir="solr" includes="build.xml" />
       </subant>
     </sequential>
