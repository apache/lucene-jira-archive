diff --git a/lucene/core/src/test/org/apache/lucene/index/TestIndexSorting.java b/lucene/core/src/test/org/apache/lucene/index/TestIndexSorting.java
index 6b43c162ec..018472c242 100644
--- a/lucene/core/src/test/org/apache/lucene/index/TestIndexSorting.java
+++ b/lucene/core/src/test/org/apache/lucene/index/TestIndexSorting.java
@@ -40,6 +40,7 @@ import org.apache.lucene.analysis.Tokenizer;
 import org.apache.lucene.analysis.tokenattributes.CharTermAttribute;
 import org.apache.lucene.analysis.tokenattributes.OffsetAttribute;
 import org.apache.lucene.analysis.tokenattributes.PayloadAttribute;
+import org.apache.lucene.codecs.Codec;
 import org.apache.lucene.codecs.FilterCodec;
 import org.apache.lucene.codecs.PointsFormat;
 import org.apache.lucene.codecs.PointsReader;
@@ -2224,6 +2225,7 @@ public class TestIndexSorting extends LuceneTestCase {
   public void testRandom3() throws Exception {
     int numDocs;
     if (TEST_NIGHTLY) {
+      assumeFalse("Don't use MemoryPostingsFormat for this test, it can OOM", Codec.getDefault().postingsFormat().getName().equals("Memory"));
       numDocs = atLeast(100000);
     } else {
       numDocs = atLeast(1000);
