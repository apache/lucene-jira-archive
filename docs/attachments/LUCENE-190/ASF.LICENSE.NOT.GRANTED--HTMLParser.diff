Index: HTMLParser.jj
===================================================================
RCS file: /home/cvspublic/jakarta-lucene/src/demo/org/apache/lucene/demo/html/HTMLParser.jj,v
retrieving revision 1.5
diff -u -r1.5 HTMLParser.jj
--- HTMLParser.jj	23 Nov 2003 18:37:32 -0000	1.5
+++ HTMLParser.jj	2 Apr 2004 21:01:08 -0000
@@ -74,7 +74,8 @@
   StringBuffer title = new StringBuffer(SUMMARY_LENGTH);
   StringBuffer summary = new StringBuffer(SUMMARY_LENGTH * 2);
   Properties metaTags=new Properties();
-  String currentMetaTag="";
+  String currentMetaTag=null;
+  String currentMetaContent=null;
   int length = 0;
   boolean titleComplete = false;
   boolean inTitle = false;
@@ -186,8 +187,10 @@
       return;
     if (inMetaTag)
     {
-	metaTags.setProperty(currentMetaTag, text);
-      	return;
+      metaTags.setProperty(currentMetaTag, currentMetaContent);
+      currentMetaTag = null;
+      currentMetaContent = null;
+      return;
     }
     if (inTitle)
       title.append(text);
@@ -284,11 +287,17 @@
 	   && t2 != null)
 	{
 		currentMetaTag=t2.image.toLowerCase();
+		if(currentMetaTag != null && currentMetaContent != null) {
+        	addText(t2.image);
+		}
 	}
     	if(inMetaTag && t1.image.equalsIgnoreCase("content") && t2 !=
 null)
 	{
-		addText(t2.image);
+		currentMetaContent=t2.image.toLowerCase();
+		if(currentMetaTag != null && currentMetaContent != null) {
+        	addText(t2.image);
+		}
 	}
      }
     )?
