Index: lucene/src/test/org/apache/lucene/util/TestArrayUtil.java
===================================================================
--- lucene/src/test/org/apache/lucene/util/TestArrayUtil.java	(revision 1098520)
+++ lucene/src/test/org/apache/lucene/util/TestArrayUtil.java	(working copy)
@@ -125,9 +125,17 @@
     return a;
   }
   
+  private Integer[] createSparseRandomArray(int maxSize) {
+    final Integer[] a = new Integer[random.nextInt(maxSize) + 1];
+    for (int i = 0; i < a.length; i++) {
+      a[i] = Integer.valueOf(random.nextInt(5));
+    }
+    return a;
+  }
+  
   public void testQuickSort() {
     for (int i = 0, c = 500 * RANDOM_MULTIPLIER; i < c; i++) {
-      Integer[] a1 = createRandomArray(1000), a2 = a1.clone();
+      Integer[] a1 = createSparseRandomArray(40000), a2 = a1.clone();
       ArrayUtil.quickSort(a1);
       Arrays.sort(a2);
       assertArrayEquals(a2, a1);
