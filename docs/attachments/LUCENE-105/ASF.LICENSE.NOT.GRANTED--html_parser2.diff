--- HTMLParser.jj.bak	2003-10-31 11:57:43.000000000 +0100
+++ HTMLParser.jj	2003-11-06 14:21:51.000000000 +0100
@@ -66,6 +66,7 @@
 package org.apache.lucene.demo.html;
 
 import java.io.*;
+import java.util.HashSet;
 import java.util.Properties;
 
 public class HTMLParser {
@@ -86,9 +87,28 @@
   String eol = System.getProperty("line.separator");
   PipedReader pipeIn = null;
   PipedWriter pipeOut;
+  HashSet ws_elems = new HashSet();	// HTML elements that display whitespace
 
   public HTMLParser(File file) throws FileNotFoundException {
     this(new FileInputStream(file));
+    ws_elems.add("<p");
+    ws_elems.add("<div");
+    ws_elems.add("<hr");
+    ws_elems.add("<hr/");	// note that "<hr />" does not need to be listed explicitly
+    ws_elems.add("<br");
+    ws_elems.add("<br/");
+    ws_elems.add("<td");
+    ws_elems.add("<li");
+    ws_elems.add("<p");
+    ws_elems.add("<q");
+    ws_elems.add("<blockquote");
+    ws_elems.add("<dt");
+    ws_elems.add("<h1");
+    ws_elems.add("<h2");
+    ws_elems.add("<h3");
+    ws_elems.add("<h4");
+    ws_elems.add("<h5");
+    ws_elems.add("<h6");
   }
 
   public String getTitle() throws IOException, InterruptedException {
@@ -246,6 +266,10 @@
 }
 {
   t1=<TagName> {
+    String tagName = t1.image.toLowerCase();
+    if( ws_elems.contains(tagName) ) {
+      addSpace();
+    }
     inTitle = t1.image.equalsIgnoreCase("<title"); // keep track if in <TITLE>
     inMetaTag = t1.image.equalsIgnoreCase("<META"); // keep track if in <META>
     inStyle = t1.image.equalsIgnoreCase("<STYLE"); // keep track if in <STYLE>
