Index: solr/common-build.xml
===================================================================
--- solr/common-build.xml	(revision 1159014)
+++ solr/common-build.xml	(working copy)
@@ -84,7 +84,6 @@
   	<pathelement path="${highlighter.jar}"/>
   	<pathelement path="${memory.jar}"/>
   	<pathelement path="${misc.jar}"/>
-  	<pathelement path="${queries-contrib.jar}"/>
   	<pathelement path="${spatial.jar}"/>
   	<pathelement path="${suggest.jar}"/>
     <pathelement path="${grouping.jar}"/>
@@ -171,7 +170,7 @@
 
   <target name="prep-lucene-jars" 
   	      depends="jar-lucene-core, jar-analyzers-phonetic, jar-suggest, jar-highlighter, jar-memory,
-  	               jar-misc, jar-queries-contrib, jar-spatial, jar-grouping, jar-queries, jar-queryparser">
+  	               jar-misc, jar-spatial, jar-grouping, jar-queries, jar-queryparser">
   	  <property name="solr.deps.compiled" value="true"/>
   </target>
 	
@@ -192,7 +191,6 @@
       <fileset file="${highlighter.jar}" />
       <fileset file="${memory.jar}" />
       <fileset file="${misc.jar}" />
-      <fileset file="${queries-contrib.jar}" />
       <fileset file="${spatial.jar}" />
     </copy>
     </sequential>
Index: modules/queries/src/test/org/apache/lucene/queries/DuplicateFilterTest.java (deleted)
===================================================================
Index: modules/queries/src/java/org/apache/lucene/queries/DuplicateFilter.java (deleted)
===================================================================
Index: lucene/contrib/contrib-build.xml
===================================================================
--- lucene/contrib/contrib-build.xml	(revision 1159014)
+++ lucene/contrib/contrib-build.xml	(working copy)
@@ -240,17 +240,6 @@
     <property name="queries.uptodate" value="true"/>
   </target>
 
-  <property name="queries-contrib.jar" value="${common.dir}/build/contrib/queries-contrib/lucene-queries-contrib-${version}.jar"/>
-  <target name="check-queries-contrib-uptodate" unless="queries-contrib.uptodate">
-    <contrib-uptodate name="queries-contrib" jarfile="${queries-contrib.jar}" contrib-src-name="queries" property="queries-contrib.uptodate"/>
-  </target>
-  <target name="jar-queries-contrib" unless="queries-contrib.uptodate" depends="check-queries-contrib-uptodate">
-    <ant dir="${common.dir}/contrib/queries" target="jar-core" inheritall="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="queries-contrib.uptodate" value="true"/>
-  </target>
-
   <property name="queryparser.jar" value="${common.dir}/../modules/queryparser/build/lucene-queryparser-${version}.jar"/>
   <target name="check-queryparser-uptodate" unless="queryparser.uptodate">
     <module-uptodate name="queryparser" jarfile="${queryparser.jar}" property="queryparser.uptodate"/>
@@ -262,6 +251,17 @@
     <property name="queryparser.uptodate" value="true"/>
   </target>
 
+  <property name="sandbox.jar" value="${common.dir}/build/contrib/sandbox/lucene-sandbox-${version}.jar"/>
+  <target name="check-sandbox-uptodate" unless="sandbox.uptodate">
+    <contrib-uptodate name="sandbox" jarfile="${sandbox.jar}" property="sandbox.uptodate"/>
+  </target>
+  <target name="jar-sandbox" unless="sandbox.uptodate" depends="check-sandbox-uptodate">
+  	<ant dir="${common.dir}/contrib/sandbox" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="sandbox.uptodate" value="true"/>
+  </target>
+
   <property name="spatial.jar" value="${common.dir}/build/contrib/spatial/lucene-spatial-${version}.jar"/>
   <target name="check-spatial-uptodate" unless="spatial.uptodate">
     <contrib-uptodate name="spatial" jarfile="${spatial.jar}" property="spatial.uptodate"/>
Index: lucene/contrib/queries/lib/jakarta-regexp-1.4.jar (deleted)
===================================================================
Index: lucene/contrib/queries/lib/jakarta-regexp-LICENSE-ASL.txt (deleted)
===================================================================
Index: lucene/contrib/queries/lib/jakarta-regexp-NOTICE.txt (deleted)
===================================================================
Index: lucene/contrib/queries/src/test/org/apache/lucene/search/FuzzyLikeThisQueryTest.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/test/org/apache/lucene/search/regex/TestRegexQuery.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/test/org/apache/lucene/search/regex/TestJakartaRegexpCapabilities.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/test/org/apache/lucene/search/regex/TestSpanRegexQuery.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/test/org/apache/lucene/search/TestSlowCollationMethods.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/SlowCollatedTermRangeTermsEnum.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/SlowCollatedTermRangeFilter.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/SlowCollatedTermRangeQuery.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/FuzzyLikeThisQuery.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/RegexQuery.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/JakartaRegexpCapabilities.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/JavaUtilRegexCapabilities.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/RegexCapabilities.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/RegexQueryCapable.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/RegexTermsEnum.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/regex/package.html (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/org/apache/lucene/search/SlowCollatedStringComparator.java (deleted)
===================================================================
Index: lucene/contrib/queries/src/java/overview.html (deleted)
===================================================================
Index: lucene/contrib/queries/README.txt (deleted)
===================================================================
Index: lucene/contrib/queries/build.xml (deleted)
===================================================================
Index: lucene/contrib/spatial/build.xml
===================================================================
--- lucene/contrib/spatial/build.xml	(revision 1159014)
+++ lucene/contrib/spatial/build.xml	(working copy)
@@ -26,10 +26,9 @@
   <import file="../contrib-build.xml"/>
 
   <path id="classpath">
-    <pathelement path="${queries-contrib.jar}"/>
     <pathelement path="${queries.jar}"/>
     <path refid="base.classpath"/>
   </path>
 
-  <target name="compile-core" depends="jar-queries-contrib, jar-queries, common.compile-core" />
+  <target name="compile-core" depends="jar-queries, common.compile-core" />
 </project>
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/FuzzyLikeThisQueryBuilder.java
===================================================================
--- lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/FuzzyLikeThisQueryBuilder.java	(revision 1159014)
+++ lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/FuzzyLikeThisQueryBuilder.java	(working copy)
@@ -1,7 +1,7 @@
 package org.apache.lucene.xmlparser.builders;
 
 import org.apache.lucene.analysis.Analyzer;
-import org.apache.lucene.search.FuzzyLikeThisQuery;
+import org.apache.lucene.sandbox.queries.FuzzyLikeThisQuery;
 import org.apache.lucene.search.FuzzyQuery;
 import org.apache.lucene.search.Query;
 import org.apache.lucene.xmlparser.DOMUtils;
Index: lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/DuplicateFilterBuilder.java
===================================================================
--- lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/DuplicateFilterBuilder.java	(revision 1159014)
+++ lucene/contrib/xml-query-parser/src/java/org/apache/lucene/xmlparser/builders/DuplicateFilterBuilder.java	(working copy)
@@ -3,7 +3,7 @@
  */
 package org.apache.lucene.xmlparser.builders;
 
-import org.apache.lucene.queries.DuplicateFilter;
+import org.apache.lucene.sandbox.queries.DuplicateFilter;
 import org.apache.lucene.search.Filter;
 import org.apache.lucene.xmlparser.DOMUtils;
 import org.apache.lucene.xmlparser.FilterBuilder;
Index: lucene/contrib/xml-query-parser/build.xml
===================================================================
--- lucene/contrib/xml-query-parser/build.xml	(revision 1159014)
+++ lucene/contrib/xml-query-parser/build.xml	(working copy)
@@ -26,11 +26,11 @@
   <import file="../contrib-build.xml"/>
 
   <path id="classpath">
-    <pathelement path="${queries-contrib.jar}"/>
     <pathelement path="${queryparser.jar}"/>
     <pathelement path="${queries.jar}"/>
+    <pathelement path="${sandbox.jar}"/>
     <path refid="base.classpath"/>
   </path>
 
-  <target name="compile-core" depends="jar-queries-contrib,jar-queryparser,jar-queries,common.compile-core" />
+  <target name="compile-core" depends="jar-sandbox,jar-queryparser,jar-queries,common.compile-core" />
 </project>
Index: lucene/contrib/highlighter/src/test/org/apache/lucene/search/highlight/HighlighterTest.java
===================================================================
--- lucene/contrib/highlighter/src/test/org/apache/lucene/search/highlight/HighlighterTest.java	(revision 1159014)
+++ lucene/contrib/highlighter/src/test/org/apache/lucene/search/highlight/HighlighterTest.java	(working copy)
@@ -55,7 +55,6 @@
 import org.apache.lucene.search.*;
 import org.apache.lucene.search.BooleanClause.Occur;
 import org.apache.lucene.search.highlight.SynonymTokenizer.TestHighlightRunner;
-import org.apache.lucene.search.regex.RegexQuery;
 import org.apache.lucene.search.spans.*;
 import org.apache.lucene.store.Directory;
 import org.apache.lucene.util.BytesRef;
@@ -337,7 +336,7 @@
   }
   
   public void testSpanRegexQuery() throws Exception {
-    query = new SpanOrQuery(new SpanMultiTermQueryWrapper<RegexQuery>(new RegexQuery(new Term(FIELD_NAME, "ken.*"))));
+    query = new SpanOrQuery(new SpanMultiTermQueryWrapper<RegexpQuery>(new RegexpQuery(new Term(FIELD_NAME, "ken.*"))));
     searcher = new IndexSearcher(ramDir, true);
     hits = searcher.search(query, 100);
     int maxNumFragmentsRequired = 2;
@@ -361,7 +360,7 @@
   }
   
   public void testRegexQuery() throws Exception {
-    query = new RegexQuery(new Term(FIELD_NAME, "ken.*"));
+    query = new RegexpQuery(new Term(FIELD_NAME, "ken.*"));
     searcher = new IndexSearcher(ramDir, true);
     hits = searcher.search(query, 100);
     int maxNumFragmentsRequired = 2;
Index: lucene/contrib/highlighter/build.xml
===================================================================
--- lucene/contrib/highlighter/build.xml	(revision 1159014)
+++ lucene/contrib/highlighter/build.xml	(working copy)
@@ -27,9 +27,8 @@
 
   <path id="classpath">
     <pathelement path="${memory.jar}"/>
-    <pathelement path="${queries-contrib.jar}"/>
     <path refid="base.classpath"/>
   </path>
 
-  <target name="compile-core" depends="jar-memory, jar-queries-contrib, common.compile-core" />
+  <target name="compile-core" depends="jar-memory, common.compile-core" />
 </project>
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/DuplicateFilterTest.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/DuplicateFilterTest.java	(revision 0)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/DuplicateFilterTest.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.queries;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestRegexQuery.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestRegexQuery.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestRegexQuery.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestJakartaRegexpCapabilities.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestJakartaRegexpCapabilities.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestJakartaRegexpCapabilities.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestSpanRegexQuery.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestSpanRegexQuery.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/regex/TestSpanRegexQuery.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/FuzzyLikeThisQueryTest.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/FuzzyLikeThisQueryTest.java	(revision 0)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/FuzzyLikeThisQueryTest.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -24,6 +24,10 @@
 import org.apache.lucene.index.IndexReader;
 import org.apache.lucene.index.RandomIndexWriter;
 import org.apache.lucene.index.Term;
+import org.apache.lucene.search.IndexSearcher;
+import org.apache.lucene.search.Query;
+import org.apache.lucene.search.ScoreDoc;
+import org.apache.lucene.search.TopDocs;
 import org.apache.lucene.store.Directory;
 import org.apache.lucene.util.LuceneTestCase;
 
Index: lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/TestSlowCollationMethods.java
===================================================================
--- lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/TestSlowCollationMethods.java	(revision 0)
+++ lucene/contrib/sandbox/src/test/org/apache/lucene/sandbox/queries/TestSlowCollationMethods.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 import java.io.IOException;
 import java.text.Collator;
@@ -8,6 +8,7 @@
 import org.apache.lucene.document.Field;
 import org.apache.lucene.index.IndexReader;
 import org.apache.lucene.index.RandomIndexWriter;
+import org.apache.lucene.search.*;
 import org.apache.lucene.search.BooleanClause.Occur;
 import org.apache.lucene.store.Directory;
 import org.apache.lucene.util.LuceneTestCase;
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/DuplicateFilter.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/DuplicateFilter.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/DuplicateFilter.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.queries;
+package org.apache.lucene.sandbox.queries;
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
  * contributor license agreements.  See the NOTICE file distributed with
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeTermsEnum.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeTermsEnum.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeTermsEnum.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -21,6 +21,7 @@
 import java.text.Collator;
 
 import org.apache.lucene.index.TermsEnum;
+import org.apache.lucene.search.FilteredTermsEnum;
 import org.apache.lucene.util.BytesRef;
 
 /**
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeFilter.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeFilter.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeFilter.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -19,6 +19,7 @@
 
 import java.text.Collator;
 
+import org.apache.lucene.search.MultiTermQueryWrapperFilter;
 import org.apache.lucene.search.NumericRangeFilter; // javadoc
 import org.apache.lucene.search.FieldCacheRangeFilter; // javadoc
 
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeQuery.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeQuery.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedTermRangeQuery.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQuery.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQuery.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQuery.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JakartaRegexpCapabilities.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JakartaRegexpCapabilities.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JakartaRegexpCapabilities.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JavaUtilRegexCapabilities.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JavaUtilRegexCapabilities.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/JavaUtilRegexCapabilities.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexCapabilities.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexCapabilities.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexCapabilities.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 import org.apache.lucene.util.BytesRef;
 
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQueryCapable.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQueryCapable.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexQueryCapable.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexTermsEnum.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexTermsEnum.java	(revision 1159014)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/regex/RegexTermsEnum.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search.regex;
+package org.apache.lucene.sandbox.queries.regex;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/FuzzyLikeThisQuery.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/FuzzyLikeThisQuery.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/FuzzyLikeThisQuery.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -30,6 +30,7 @@
 import org.apache.lucene.index.IndexReader;
 import org.apache.lucene.index.MultiFields;
 import org.apache.lucene.index.Term;
+import org.apache.lucene.search.*;
 import org.apache.lucene.util.AttributeSource;
 import org.apache.lucene.util.BytesRef;
 import org.apache.lucene.util.PriorityQueue;
Index: lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedStringComparator.java
===================================================================
--- lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedStringComparator.java	(revision 0)
+++ lucene/contrib/sandbox/src/java/org/apache/lucene/sandbox/queries/SlowCollatedStringComparator.java	(working copy)
@@ -1,4 +1,4 @@
-package org.apache.lucene.search;
+package org.apache.lucene.sandbox.queries;
 
 /**
  * Licensed to the Apache Software Foundation (ASF) under one or more
@@ -21,7 +21,9 @@
 import java.text.Collator;
 
 import org.apache.lucene.index.IndexReader.AtomicReaderContext;
+import org.apache.lucene.search.FieldCache;
 import org.apache.lucene.search.FieldCache.DocTerms;
+import org.apache.lucene.search.FieldComparator;
 import org.apache.lucene.util.BytesRef;
 
 /** Sorts by a field's value using the given Collator
Index: lucene/contrib/sandbox/src/java/overview.html
===================================================================
--- lucene/contrib/sandbox/src/java/overview.html	(revision 0)
+++ lucene/contrib/sandbox/src/java/overview.html	(revision 0)
@@ -0,0 +1,26 @@
+<!--
+  Licensed to the Apache Software Foundation (ASF) under one or more
+  contributor license agreements.  See the NOTICE file distributed with
+  this work for additional information regarding copyright ownership.
+  The ASF licenses this file to You under the Apache License, Version 2.0
+  (the "License"); you may not use this file except in compliance with
+  the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+<html>
+  <head>
+    <title>
+      Sandbox
+    </title>
+  </head>
+  <body>
+  Sandbox
+  </body>
+</html>
Index: lucene/contrib/sandbox/build.xml
===================================================================
--- lucene/contrib/sandbox/build.xml	(revision 0)
+++ lucene/contrib/sandbox/build.xml	(revision 0)
@@ -0,0 +1,35 @@
+<!--
+  Licensed to the Apache Software Foundation (ASF) under one or more
+  contributor license agreements.  See the NOTICE file distributed with
+  this work for additional information regarding copyright ownership.
+  The ASF licenses this file to You under the Apache License, Version 2.0
+  (the "License"); you may not use this file except in compliance with
+  the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+  -->
+
+<project name="sandbox" default="default">
+
+  <description>
+    Sandbox for odd contrib code
+  </description>
+
+  <path id="additional.dependencies">
+    <fileset dir="lib" includes="*-regexp-*.jar"/>
+  </path>
+
+  <pathconvert property="project.classpath"
+               targetos="unix"
+               refid="additional.dependencies"
+  />
+
+  <import file="../contrib-build.xml"/>
+
+</project>
Index: lucene/build.xml
===================================================================
--- lucene/build.xml	(revision 1159014)
+++ lucene/build.xml	(working copy)
@@ -255,7 +255,7 @@
           <packageset dir="contrib/instantiated/src/java"/>
           <packageset dir="contrib/memory/src/java"/>
           <packageset dir="contrib/misc/src/java"/>
-          <packageset dir="contrib/queries/src/java"/>
+          <packageset dir="contrib/sandbox/src/java"/>
           <packageset dir="contrib/spatial/src/java"/>
           <packageset dir="contrib/xml-query-parser/src/java"/>
           <!-- end alpha sort -->
@@ -272,7 +272,7 @@
           <group title="contrib: Instantiated" packages="org.apache.lucene.store.instantiated*"/>
           <group title="contrib: Memory" packages="org.apache.lucene.index.memory*"/>
           <group title="contrib: Misc " packages="org.apache.lucene.misc*"/>
-          <group title="contrib: Queries" packages="org.apache.lucene.search.similar*:org.apache.lucene.search.regex*:org.apache.regexp*"/>
+          <group title="contrib: Sandbox" packages="org.apache.lucene.sandbox*"/>
           <group title="contrib: Spatial" packages="org.apache.lucene.spatial*"/>
           <group title="contrib: XML Query Parser" packages="org.apache.lucene.xmlparser*"/>
           
Index: dev-tools/idea/solr/solr.iml
===================================================================
--- dev-tools/idea/solr/solr.iml	(revision 1159014)
+++ dev-tools/idea/solr/solr.iml	(working copy)
@@ -24,7 +24,6 @@
     <orderEntry type="module" module-name="grouping" />
     <orderEntry type="module" module-name="highlighter" />
     <orderEntry type="module" module-name="icu" />
-    <orderEntry type="module" module-name="queries-contrib" />
     <orderEntry type="module" module-name="queries" />
     <orderEntry type="module" module-name="misc" />
     <orderEntry type="module" module-name="phonetic" />
Index: dev-tools/idea/.idea/modules.xml
===================================================================
--- dev-tools/idea/.idea/modules.xml	(revision 1159014)
+++ dev-tools/idea/.idea/modules.xml	(working copy)
@@ -9,8 +9,8 @@
       <module filepath="$PROJECT_DIR$/lucene/contrib/instantiated/instantiated.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/memory/memory.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/misc/misc.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/contrib/queries/queries-contrib.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/spatial/spatial.iml" />
+      <module filepath="$PROJECT_DIR$/lucene/contrib/sandbox/sandbox.iml" />
       <module filepath="$PROJECT_DIR$/lucene/contrib/xml-query-parser/xml-query-parser.iml" />
       <module filepath="$PROJECT_DIR$/modules/analysis/common/analysis-common.iml" />
       <module filepath="$PROJECT_DIR$/modules/analysis/icu/icu.iml" />
Index: dev-tools/idea/.idea/workspace.xml
===================================================================
--- dev-tools/idea/.idea/workspace.xml	(revision 1159014)
+++ dev-tools/idea/.idea/workspace.xml	(working copy)
@@ -127,13 +127,6 @@
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
     </configuration>
-    <configuration default="false" name="queries contrib" type="JUnit" factoryName="JUnit">
-      <module name="queries-contrib" />
-      <option name="TEST_OBJECT" value="package" />
-      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/lucene/build/contrib/queries" />
-      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
-      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
-    </configuration>
     <configuration default="false" name="queries module" type="JUnit" factoryName="JUnit">
       <module name="queries" />
       <option name="TEST_OBJECT" value="package" />
@@ -148,6 +141,13 @@
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
     </configuration>
+    <configuration default="false" name="sandbox contrib" type="JUnit" factoryName="JUnit">
+      <module name="sandbox" />
+      <option name="TEST_OBJECT" value="package" />
+      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/lucene/build/contrib/sandbox" />
+      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
+      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+    </configuration>
     <configuration default="false" name="smartcn analysis module" type="JUnit" factoryName="JUnit">
       <module name="smartcn" />
       <option name="TEST_OBJECT" value="package" />
@@ -216,9 +216,9 @@
       <item index="15" class="java.lang.String" itemvalue="JUnit.misc contrib" />
       <item index="16" class="java.lang.String" itemvalue="JUnit.morfologik analysis module" />
       <item index="17" class="java.lang.String" itemvalue="JUnit.phonetic analysis module" />
-      <item index="18" class="java.lang.String" itemvalue="JUnit.queries contrib" />
-      <item index="19" class="java.lang.String" itemvalue="JUnit.queries module" />
-      <item index="20" class="java.lang.String" itemvalue="JUnit.queryparser module" />
+      <item index="18" class="java.lang.String" itemvalue="JUnit.queries module" />
+      <item index="19" class="java.lang.String" itemvalue="JUnit.queryparser module" />
+      <item index="20" class="java.lang.String" itemvalue="JUnit.sandbox contrib" />
       <item index="21" class="java.lang.String" itemvalue="JUnit.smartcn analysis module" />
       <item index="22" class="java.lang.String" itemvalue="JUnit.solr" />
       <item index="23" class="java.lang.String" itemvalue="JUnit.spatial contrib" />
Index: dev-tools/idea/lucene/contrib/queries/queries-contrib.iml (deleted)
===================================================================
Index: dev-tools/idea/lucene/contrib/spatial/spatial.iml
===================================================================
--- dev-tools/idea/lucene/contrib/spatial/spatial.iml	(revision 1159014)
+++ dev-tools/idea/lucene/contrib/spatial/spatial.iml	(working copy)
@@ -11,7 +11,6 @@
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
-    <orderEntry type="module" module-name="queries-contrib" />
     <orderEntry type="module" module-name="misc" />
     <orderEntry type="module" module-name="lucene" />
     <orderEntry type="module" module-name="queries" />
Index: dev-tools/idea/lucene/contrib/xml-query-parser/xml-query-parser.iml
===================================================================
--- dev-tools/idea/lucene/contrib/xml-query-parser/xml-query-parser.iml	(revision 1159014)
+++ dev-tools/idea/lucene/contrib/xml-query-parser/xml-query-parser.iml	(working copy)
@@ -11,8 +11,8 @@
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
-    <orderEntry type="module" module-name="queries-contrib" />
     <orderEntry type="module" module-name="misc" />
+    <orderEntry type="module" module-name="sandbox" />
     <orderEntry type="module" module-name="analysis-common" />
     <orderEntry type="module" module-name="lucene" />
     <orderEntry type="module" module-name="queryparser" />
Index: dev-tools/idea/lucene/contrib/highlighter/highlighter.iml
===================================================================
--- dev-tools/idea/lucene/contrib/highlighter/highlighter.iml	(revision 1159014)
+++ dev-tools/idea/lucene/contrib/highlighter/highlighter.iml	(working copy)
@@ -12,7 +12,6 @@
     <orderEntry type="sourceFolder" forTests="false" />
     <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
     <orderEntry type="module" module-name="memory" />
-    <orderEntry type="module" module-name="queries-contrib" />
     <orderEntry type="module" module-name="misc" />
     <orderEntry type="module" module-name="lucene" />
   </component>
Index: dev-tools/idea/lucene/contrib/sandbox/sandbox.iml
===================================================================
--- dev-tools/idea/lucene/contrib/sandbox/sandbox.iml	(revision 0)
+++ dev-tools/idea/lucene/contrib/sandbox/sandbox.iml	(revision 0)
@@ -0,0 +1,26 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output url="file://$MODULE_DIR$/../../build/contrib/sandbox/classes/java" />
+    <output-test url="file://$MODULE_DIR$/../../build/contrib/sandbox/classes/test" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="module-library">
+      <library>
+        <CLASSES>
+          <root url="jar://$MODULE_DIR$/lib/jakarta-regexp-1.4.jar!/" />
+        </CLASSES>
+        <JAVADOC />
+        <SOURCES />
+      </library>
+    </orderEntry>
+    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
+    <orderEntry type="module" module-name="lucene" />
+  </component>
+</module>
+
Index: dev-tools/eclipse/dot.classpath
===================================================================
--- dev-tools/eclipse/dot.classpath	(revision 1159014)
+++ dev-tools/eclipse/dot.classpath	(working copy)
@@ -14,8 +14,8 @@
 	<classpathentry kind="src" path="lucene/contrib/memory/src/test"/>
 	<classpathentry kind="src" path="lucene/contrib/misc/src/java"/>
 	<classpathentry kind="src" path="lucene/contrib/misc/src/test"/>
-	<classpathentry kind="src" path="lucene/contrib/queries/src/java"/>
-	<classpathentry kind="src" path="lucene/contrib/queries/src/test"/>
+	<classpathentry kind="src" path="lucene/contrib/sandbox/src/java"/>
+	<classpathentry kind="src" path="lucene/contrib/sandbox/src/test"/>
 	<classpathentry kind="src" path="lucene/contrib/spatial/src/java"/>
 	<classpathentry kind="src" path="lucene/contrib/spatial/src/test"/>
 	<classpathentry kind="src" path="lucene/contrib/xml-query-parser/src/java"/>
Index: dev-tools/maven/solr/core/pom.xml.template
===================================================================
--- dev-tools/maven/solr/core/pom.xml.template	(revision 1159014)
+++ dev-tools/maven/solr/core/pom.xml.template	(working copy)
@@ -78,11 +78,6 @@
     </dependency>
     <dependency>
       <groupId>org.apache.lucene</groupId>
-      <artifactId>lucene-queries-contrib</artifactId>
-      <version>${project.version}</version>
-    </dependency>
-    <dependency>
-      <groupId>org.apache.lucene</groupId>
       <artifactId>lucene-queryparser</artifactId>
       <version>${project.version}</version>
     </dependency>
Index: dev-tools/maven/lucene/contrib/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/pom.xml.template	(revision 1159014)
+++ dev-tools/maven/lucene/contrib/pom.xml.template	(working copy)
@@ -36,7 +36,7 @@
     <module>instantiated</module>
     <module>memory</module>
     <module>misc</module>
-    <module>queries</module>
+    <module>sandbox</module>
     <module>spatial</module>
     <module>xml-query-parser</module>
   </modules>
Index: dev-tools/maven/lucene/contrib/queries/pom.xml.template (deleted)
===================================================================
Index: dev-tools/maven/lucene/contrib/spatial/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/spatial/pom.xml.template	(revision 1159014)
+++ dev-tools/maven/lucene/contrib/spatial/pom.xml.template	(working copy)
@@ -49,11 +49,6 @@
     </dependency>
     <dependency>
       <groupId>${project.groupId}</groupId>
-      <artifactId>lucene-queries-contrib</artifactId>
-      <version>${project.version}</version>
-    </dependency>
-    <dependency>
-      <groupId>${project.groupId}</groupId>
       <artifactId>lucene-queries</artifactId>
       <version>${project.version}</version>
     </dependency>
Index: dev-tools/maven/lucene/contrib/xml-query-parser/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/xml-query-parser/pom.xml.template	(revision 1159014)
+++ dev-tools/maven/lucene/contrib/xml-query-parser/pom.xml.template	(working copy)
@@ -49,12 +49,12 @@
     </dependency>
     <dependency>
       <groupId>${project.groupId}</groupId>
-      <artifactId>lucene-queries-contrib</artifactId>
+      <artifactId>lucene-queries</artifactId>
       <version>${project.version}</version>
     </dependency>
     <dependency>
       <groupId>${project.groupId}</groupId>
-      <artifactId>lucene-queries</artifactId>
+      <artifactId>lucene-sandbox</artifactId>
       <version>${project.version}</version>
     </dependency>
     <dependency>
Index: dev-tools/maven/lucene/contrib/highlighter/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/highlighter/pom.xml.template	(revision 1159014)
+++ dev-tools/maven/lucene/contrib/highlighter/pom.xml.template	(working copy)
@@ -55,11 +55,6 @@
       <version>${project.version}</version>
     </dependency>
     <dependency>
-      <groupId>${project.groupId}</groupId>
-      <artifactId>lucene-queries-contrib</artifactId>
-      <version>${project.version}</version>
-    </dependency>
-    <dependency>
       <groupId>junit</groupId>
       <artifactId>junit</artifactId>
       <scope>test</scope>
Index: dev-tools/maven/lucene/contrib/sandbox/pom.xml.template
===================================================================
--- dev-tools/maven/lucene/contrib/sandbox/pom.xml.template	(revision 0)
+++ dev-tools/maven/lucene/contrib/sandbox/pom.xml.template	(revision 0)
@@ -0,0 +1,71 @@
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <!--
+    Licensed to the Apache Software Foundation (ASF) under one
+    or more contributor license agreements.  See the NOTICE file
+    distributed with this work for additional information
+    regarding copyright ownership.  The ASF licenses this file
+    to you under the Apache License, Version 2.0 (the
+    "License"); you may not use this file except in compliance
+    with the License.  You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing,
+    software distributed under the License is distributed on an
+    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+    KIND, either express or implied.  See the License for the
+    specific language governing permissions and limitations
+    under the License.
+  -->
+  <modelVersion>4.0.0</modelVersion>
+  <parent>
+    <groupId>org.apache.lucene</groupId>
+    <artifactId>lucene-parent</artifactId>
+    <version>@version@</version>
+    <relativePath>../../pom.xml</relativePath>
+  </parent>
+  <groupId>org.apache.lucene</groupId>
+  <artifactId>lucene-sandbox</artifactId>
+  <packaging>jar</packaging>
+  <name>Lucene Sandbox</name>
+  <description>Lucene Sandbox</description>
+  <properties>
+    <module-directory>lucene/contrib/sandbox</module-directory>
+    <build-directory>../../build/contrib/sandbox</build-directory>
+  </properties>
+  <dependencies>
+    <dependency>
+      <groupId>${project.groupId}</groupId>
+      <artifactId>lucene-core</artifactId>
+      <version>${project.version}</version>
+    </dependency>
+    <dependency>
+      <groupId>${project.groupId}</groupId>
+      <artifactId>lucene-test-framework</artifactId>
+      <version>${project.version}</version>
+      <scope>test</scope>
+    </dependency>
+    <dependency>
+      <groupId>junit</groupId>
+      <artifactId>junit</artifactId>
+      <scope>test</scope>
+    </dependency>
+  </dependencies>
+  <build>
+    <directory>${build-directory}</directory>
+    <outputDirectory>${build-directory}/classes/java</outputDirectory>
+    <testOutputDirectory>${build-directory}/classes/test</testOutputDirectory>
+    <sourceDirectory>src/java</sourceDirectory>
+    <testSourceDirectory>src/test</testSourceDirectory>
+    <testResources>
+      <testResource>
+        <directory>${project.build.testSourceDirectory}</directory>
+        <excludes>
+          <exclude>**/*.java</exclude>
+        </excludes>
+      </testResource>
+    </testResources>
+  </build>
+</project>
