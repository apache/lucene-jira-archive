Index: lucene/lucene.bnd
===================================================================
--- lucene/lucene.bnd	(revision 0)
+++ lucene/lucene.bnd	(revision 0)
@@ -0,0 +1,17 @@
+Export-Package: *;-split-package:=merge-first
+Extension-Name: org.apache.lucene
+Specification-Title: Lucene Search Engine: ${ant.project.name}
+Specification-Version: ${spec.version}
+Specification-Vendor: The Apache Software Foundation
+Implementation-Title: org.apache.lucene
+Implementation-Version: ${version} ${svnversion} - ${DSTAMP} ${TSTAMP}
+Implementation-Vendor: The Apache Software Foundation
+X-Compile-Source-JDK: ${javac.source}
+X-Compile-Target-JDK: ${javac.target}
+Bundle-License: http://www.apache.org/licenses/LICENSE-2.0.txt
+Bundle-SymbolicName: org.apache.lucene.${name}
+Bundle-Name: Lucene Search Engine: ${ant.project.name}
+Bundle-Vendor: The Apache Software Foundation
+Bundle-Version: ${version}
+Bundle-Description: ${bnd.project.description}
+Bundle-DocUR: http://www.apache.org/
Index: lucene/common-build.xml
===================================================================
--- lucene/common-build.xml	(revision 1154566)
+++ lucene/common-build.xml	(working copy)
@@ -372,43 +372,18 @@
     <attribute name="implementation.title"/>
     <attribute name="spec.version"/>
     <sequential>
-      <manifest file="${manifest.file}">
-        <!--
-        http://java.sun.com/j2se/1.5.0/docs/guide/jar/jar.html#JAR%20Manifest
-        http://java.sun.com/j2se/1.5.0/docs/guide/versioning/spec/versioning2.html
-        http://java.sun.com/j2se/1.5.0/docs/api/java/lang/Package.html
-        http://java.sun.com/j2se/1.5.0/docs/api/java/util/jar/package-summary.html
-        http://java.sun.com/developer/Books/javaprogramming/JAR/basics/manifest.html
-        -->
-        <!-- Don't set 'Manifest-Version' it identifies the version of the
-             manifest file format, and should always be 1.0 (the default)
-
-             Don't set 'Created-by' attribute, its purpose is
-             to identify the version of java used to build the jar,
-             which ant will do by default.
-
-             Ant will happily override these with bogus strings if you
-             tell it to, so don't.
-
-             NOTE: we don't use section info because all of our manifest data
-             applies to the entire jar/war ... no package specific info.
-        -->
-        <attribute name="Extension-Name" value="@{implementation.title}"/>
-        <attribute name="Specification-Title" value="@{title}"/>
-        <!-- spec version must match "digit+{.digit+}*" -->
-        <attribute name="Specification-Version" value="@{spec.version}"/>
-        <attribute name="Specification-Vendor"
-                   value="The Apache Software Foundation"/>
-        <attribute name="Implementation-Title" value="@{implementation.title}"/>
-        <!-- impl version can be any string -->
-        <attribute name="Implementation-Version"
-                   value="${version} ${svnversion} - ${user.name} - ${DSTAMP} ${TSTAMP}"/>
-        <attribute name="Implementation-Vendor"
-                   value="The Apache Software Foundation"/>
-        <attribute name="X-Compile-Source-JDK" value="${javac.source}"/>
-        <attribute name="X-Compile-Target-JDK" value="${javac.target}"/>
-      </manifest>
-    </sequential>
+      <xmlproperty file="${ant.file}" collapseAttributes="true" prefix="bnd"/>
+      <property name="bndclasspath" refid="classpath"/>
+  	  <property name="-savemanifest" value="${common.dir}/build/MANIFEST.MF"/>
+      <property name="-output" value="${common.dir}/build"/>
+  	  <taskdef resource="aQute/bnd/ant/taskdef.properties" /> 
+  	  <bnd 
+  	      classpath="${bndclasspath}" 
+  	      eclipse="false" 
+  	      failok="false" 
+  	      exceptions="true"
+  	      files="${common.dir}/lucene.bnd" /> 
+  	</sequential>
   </macrodef>
 	
   <macrodef name="jarify" description="Builds a JAR file">
Index: solr/common-build.xml
===================================================================
--- solr/common-build.xml	(revision 1154566)
+++ solr/common-build.xml	(working copy)
@@ -201,6 +201,17 @@
   <!-- Shared core/solrj/test-framework/contrib targets -->
   <target name="jar-core" depends="compile-core">
     <mkdir dir="${dest}/META-INF/"/>
+  	<property name="bndclasspath" refid="classpath"/>
+    <property name="-savemanifest" value="${dest}/META-INF/MANIFEST.MF"/>
+    <property name="-output" value="${dest}"/>
+    <xmlproperty file="${ant.file}" collapseAttributes="true" prefix="bnd"/>
+ 	<taskdef resource="aQute/bnd/ant/taskdef.properties" /> 
+ 	<bnd 
+ 	        classpath="${bndclasspath}" 
+ 	        eclipse="false" 
+ 	        failok="false" 
+ 	        exceptions="true"
+ 	        files="${common-solr.dir}/lucene.bnd" /> 
     <jarify title="Apache Solr Search Server: ${ant.project.name}"
             metainf.source.dir="${common-solr.dir}"
             implementation.title="org.apache.solr"
Index: solr/lucene.bnd
===================================================================
--- solr/lucene.bnd	(revision 0)
+++ solr/lucene.bnd	(revision 0)
@@ -0,0 +1,17 @@
+Export-Package: *;-split-package:=merge-first
+Extension-Name: org.apache.solr
+Specification-Title: Apache Solr Search Server
+Specification-Version: ${specversion}
+Specification-Vendor: The Apache Software Foundation
+Implementation-Title: org.apache.solr
+Implementation-Version: ${version} ${svnversion} - ${user.name} - ${DSTAMP} ${TSTAMP}
+Implementation-Vendor: The Apache Software Foundation
+X-Compile-Source-JDK: ${java.compat.version}
+X-Compile-Target-JDK: ${java.compat.version}
+Bundle-License: http://www.apache.org/licenses/LICENSE-2.0.txt
+Bundle-SymbolicName: org.apache.solr.${name}
+Bundle-Name: Apache Solr Search Server: ${ant.project.name}
+Bundle-Vendor: The Apache Software Foundation
+Bundle-Version: ${version}
+Bundle-Description: ${bnd.project.description}
+Bundle-DocUR: http://www.apache.org/
\ No newline at end of file
